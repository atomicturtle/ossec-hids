<!-- Apache decoder.
  - Updated by jesus@wazuh.com. 2016/02/17
  - Will extract the srcip
  - Examples:
  - Without ID: Will extract the srcip and srcport (when it is available)
      - [error] [client 80.230.208.105] Directory index forbidden by rule: /home/
      - [error] [client 64.94.163.159] Client sent malformed Host header
      - [error] [client 66.31.142.16] File does not exist: /var/www/html/default.ida
      - [Sun Nov 23 18:49:01.713508 2014] [:error] [pid 15816] [client 141.8.147.9:51507] PHP Notice:  A non well formed numeric value encountered in /path/to/file.php on line 123
      - Feb 17 18:00:00 myhost httpd[18660]: [error] [client 12.34.56.78] File does not exist: /usr/local/htdocs/cache
      - Feb 17 18:00:00 myhost httpd[23745]: [error] [client 12.34.56.78] PHP Notice:
  - With IP + ID: Will extract the srcip, id, and srcport (when it is available)
      - [Tue Sep 30 11:30:13.262255 2014] [core:error] [pid 20101] [client 99.47.227.95:34567] AH00037: Symbolic link not allowed or link target not accessible: /usr/share/awstats/icon/mime/document.png
      - [Tue Sep 30 12:24:22.891366 2014] [proxy:warn] [pid 2331] [client 77.127.180.111:54082] AH01136: Unescaped URL path matched ProxyPass; ignoring unsafe nocanon, referer: http://www.easylinker.co.il/he/links.aspx?user=bguyb
      - [Tue Sep 30 14:25:44.895897 2014] [authz_core:error] [pid 31858] [client 99.47.227.95:38870] AH01630: client denied by server configuration: /var/www/example.com/docroot/
      - [Thu Oct 23 15:17:55.926067 2014] [ssl:info] [pid 18838] [client 36.226.119.49:2359] AH02008: SSL library error 1 in handshake (server www.example.com:443)
      - ModSecurity
        - [Tue Feb 16 04:02:21.018764 2016] [:error] [pid 3223] [client 10.10.10.10] ModSecurity: Access denied with code 403 (phase 2). Text...
        - [Tue Feb 16 04:02:21.018764 2016] [:error] [pid 3223] [client 10.10.10.10:5555] ModSecurity: Access denied with code 403 (phase 2). Text...
  - Others
      - [notice] Apache configured
      - [Thu Oct 23 15:17:55.926123 2014] [ssl:info] [pid 18838] SSL Library Error: error:1407609B:SSL routines:SSL23_GET_CLIENT_HELLO:https proxy request -- speaking HTTP to HTTPS port!?
      - [Tue Sep 30 12:11:21.258612 2014] [ssl:error] [pid 30473] AH02032: Hostname www.example.com provided via SNI and hostname ssl://www.example.com provided via HTTP are different
-->

<decoder name="apache-errorlog">
    <program_name_pcre2>^httpd</program_name_pcre2>
</decoder>

<decoder name="apache-errorlog">
    <prematch_pcre2>^\[warn\] |^\[notice\] |^\[error\] </prematch_pcre2>
</decoder>

<decoder name="apache-errorlog">
    <prematch_pcre2>^\[\w+ \w+ \d+ \d+:\d+:\d+\.\d+ \d+\] (?:\[\S+:warn\]|\[\S+:notice\]|\[\S*:error\]|\[\S+:info\]) </prematch_pcre2>
</decoder>

<decoder name="apache24-errorlog-ip-port">
    <parent>apache-errorlog</parent>
    <prematch_pcre2 offset="after_parent">\[client \S+:\d+?\] \S+:</prematch_pcre2>
    <pcre2 offset="after_parent">\[client (\S+):(\d+?)\] (\S+): </pcre2>
    <order>srcip,srcport,id</order>
</decoder>

<decoder name="apache24-errorlog-ip">
    <parent>apache-errorlog</parent>
    <prematch_pcre2 offset="after_parent">\[client \S+\] \S+:</prematch_pcre2>
    <pcre2 offset="after_parent">\[client (\S+)\] (\S+): </pcre2>
    <order>srcip,id</order>
</decoder>


<decoder name="apache-errorlog-ip">
    <parent>apache-errorlog</parent>
    <prematch_pcre2 offset="after_parent">\[client</prematch_pcre2>
    <pcre2 offset="after_prematch">^ (\S+):(\d+?)\] |^ (\S+)\] </pcre2>
    <order>srcip,srcport</order>
</decoder>



<!-- Nginx error log decoder.
  - Will extract the srcip.
  - Examples:
  - 2009/09/15 20:55:40 [error] 63858#0: *3663 open() "/srv/www/ossec.net/robots.txt" failed (2: No such file or directory), client: 1.2.3.4, server: ossec.net, request: "GET /robots.txt HTTP/1.1", host: "www.ossec.net"
  - 2009/09/15 19:51:07 [error] 37992#0: accept() failed (53: Software caused connection abort)
  -->
<decoder name="nginx-errorlog">
  <prematch_pcre2>^20\d{2}/\d{2}/\d{2} \d{2}:\d{2}:\d{2} \[</prematch_pcre2>
</decoder>

<decoder name="nginx-errorlog-ip">
  <parent>nginx-errorlog</parent>
  <prematch_pcre2 offset="after_parent">, client: \S+, server: \S+, request: "\S+ </prematch_pcre2>
  <pcre2 offset="after_parent">, client: (\S+), </pcre2>
  <order>srcip</order>
</decoder>




<!-- NCSA common log decoder (used by apache, Lotus Domino and IIS NCSA).
  -  Will extract the srcip, url and id.
  -  Every web access log must use "web-log" as their
  -  type if they want to be matched against the web rules.
  - Examples:
  -  63.91.167.39 - - [03/Aug/2001:21:56:18 -0700] "GET /default.ida?NNNN
  -  206.78.62.16 - - [06/Aug/2001:08:57:08 -0700] "GET /default.ida?XX
  -  5.211.112.6 - - [04/Feb/2003:16:17:30 -0500] "GET /mod_ssl:error:
  -  192.168.2.190 - - [18/Jan/2006:13:10:06 -0500] "GET /xxx.html HTTP/1.1"
     200 1732
  -  1.1.1.1 - username [18/Jan/2006:13:10:06 -0500] "GET /xxx.html HTTP/1.1"
  -  123.4.5.6 aa.xx.com - [05/Nov/2006:00:46:56 -0500] "GET / HTTP/1.1" 302 -
  - ::ffff:202.194.15.192 190.7.138.180 - [18/Oct/2010:10:48:55 -0500] "GET //php-my-admin/config/config.inc.php?p=phpinfo(); HTTP/1.1" 404 345 "-"  "Mozilla/4.0 (compatible; MSIE 6.0; Windows 98)"
  -->
<decoder name="web-accesslog">
  <type>web-log</type>
  <prematch_pcre2>^\S+ \S+ \S+ \[\S+ \S\d+\] "\w+ \S+ HTTP\S+" </prematch_pcre2>
  <pcre2>^(\S+) \S+ (\S+) \[\S+ \S\d+\] </pcre2>
  <pcre2>"(\w+) (\S+) HTTP\S+" (\d+) </pcre2>
  <order>srcip, srcuser, action, url, id</order>
</decoder>


<!-- Windows date format.
  -  Pre match for windows date format. Used on Windows firewall,
  -  IIS, etc.
  -  Examples:
  -  2006-07-23 04:40:02 xxx
  -->
<decoder name="windows-date-format">
  <prematch_pcre2>^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2} </prematch_pcre2>
</decoder>



<!-- Windows firewall decoder.
  - Will extract action, protocol, srcip, dstip, srcport and dstport.
  - Examples:
  - 2006-09-18 22:25:30 OPEN TCP 11.12.72.10 12.252.71.6 3311 445 - - - - - - - - -
  - 2006-09-18 22:26:23 DROP UDP 11.152.183.14 239.255.255.250 65299 1900 310 - - - - - - - RECEIVE
  - 2006-09-18 22:26:23 DROP UDP 11.152.183.14 239.255.255.250 65299 1900 310 - - - - - - - RECEIVE
  - 2006-09-18 22:26:23 DROP UDP 11.152.183.14 239.255.255.250 65298 1900 319 - - - - - - - RECEIVE
  -->
<decoder name="windows-firewall">
  <parent>windows-date-format</parent>
  <type>firewall</type>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^OPEN|^CLOSE|^DROP</prematch_pcre2>
  <pcre2 offset="after_parent">^(\w+) (\w+) </pcre2>
  <pcre2>(\S+) (\S+) (\d+) (\d+) </pcre2>
  <order>action, protocol, srcip, dstip, srcport, dstport</order>
</decoder>


<!-- IIS 5 WWW W3C log format.
  - #Fields: date time c-ip cs-username s-sitename s-computername s-ip s-port cs-method cs-uri-stem cs-uri-query sc-status cs-host cs(User-Agent) cs(Referer)
  - Examples:
  - 2006-07-23 04:40:02 1.2.3.4 - W3SVC3 CIN1WEB03 1.2.3.4 443 GET /Default.asp - 200 hiden.com Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.1;+Avant+Browser;+Avant+Browser;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727) -
  -->
<decoder name="web-accesslog-iis5">
  <parent>windows-date-format</parent>
  <type>web-log</type>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^\S+ \S+ W3SVC</prematch_pcre2>
  <pcre2 offset="after_parent">^(\S+) \S+ \S+ \S+ \S+ </pcre2>
  <pcre2>\d+ \S+ (\S+ \S+) (\d+) </pcre2>
  <order>srcip,url,id</order>
</decoder>


<!-- IIS6 WWW W3C log format.
  - #Fields: date time s-sitename s-computername s-ip cs-method cs-uri-stem
  cs-uri-query s-port cs-username c-ip cs-version cs(User-Agent)
  cs(Cookie) cs(Referer) cs-host sc-status sc-substatus sc-win32-status
  sc-bytes cs-bytes time-taken
  - Examples:
  - 2007-01-22 05:00:11 W3SVC1 HOSTNAME 1.1.1.1 POST /SimpleAuthWebService/SimpleAuth.asmx - 80 - 2.2.2.2 HTTP/1.1 Windows-Update-Agent - - hostname 200 0 0 1467 841 31
  -->
<decoder name="web-accesslog-iis6">
  <parent>windows-date-format</parent>
  <type>web-log</type>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^W3SVC\d+ \S+ \S+ \S+ </prematch_pcre2>
  <pcre2 offset="after_prematch">^(\S+ \S+) \d+ \S+ (\S+) </pcre2>
  <pcre2>\S+ \S+ \S+ \S+ \S+ (\d+) </pcre2>
  <order>url, srcip, id</order>
</decoder>

<!-- Windows IIS decoder for default settings
  -  Tested with IIS 7.5 and IIS 8.5 (Windows 2008R2 and Windows 2012R2)
  -  Will extract URL, Source IP, and HTTP response code
  -  Examples:
  -  IIS 7.5
  -  2015-07-28 15:07:26 1.2.3.4 GET /QOsa/Browser/Default.aspx UISessionId=SN1234123&DeviceId=SN12312232SHARP+MX-4111N 80 - 31.3.3.7 OpenSystems/1.0;+product-family="85";+product-version="123ER123" 302 0 0 624
  -  IIS 8.5
  -  2015-03-11 20:28:21 1.2.3.4 GET /certsrv/Default.asp - 80 - 31.3.3.7 Mozilla/5.0+(compatible;+MSIE+9.0;+Windows+NT+6.1;+WOW64;+Trident/7.0) - 401 2 5 0
  -  2015-03-11 21:59:09 1.2.3.4 GET /console/faces/com_sun_web_ui/jsp/version/version_30.jsp - 80 - 31.3.3.7 Sun+Web+Console+Fingerprinter/7.15 - 404 0 2 0
  -  2015-03-11 22:01:58 1.2.3.4 GET /IISADMPWD/aexp.htr - 80 - 31.3.3.7 - - 404 0 2 0
-->

<decoder name="web-accesslog-iis-default">
  <parent>windows-date-format</parent>
  <type>web-log</type>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^\S+ GET |^\S+ POST </prematch_pcre2>
  <pcre2 offset="after_prematch">(\S+ \S*) .* (\S+) \S*.* (\d{3}) \S+ \S+ \S+</pcre2>
  <order>url,srcip,id</order>
</decoder>


<!-- IIS 5 W3C FTP log format.
  - Examples:
  - #Fields: date time c-ip cs-username s-sitename s-computername s-ip s-port cs-method cs-uri-stem cs-uri-query sc-status sc-win32-status sc-bytes cs-bytes time-taken cs-version cs-host cs(User-Agent) cs(Cookie) cs(Referer)
  - 2006-07-23 17:57:59 192.168.3.64 Administrator MSFTPSVC1 HAIJO2 192.168.1.12 21 [144]USER Administrator - 331 0 0 0 0 FTP - - - -
  - 2006-07-23 17:57:59 192.168.3.64 Administrator MSFTPSVC1 HAIJO2 192.168.1.12 21 [144]PASS - - 230 0 0 0 16 FTP - - - -
  -->
<decoder name="msftp">
  <parent>windows-date-format</parent>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^\S+ \S+ MSFTPSVC</prematch_pcre2>
  <pcre2 offset="after_parent">^(\S+) (\S+) \S+ \S+ \S+ </pcre2>
  <pcre2>\d+ \[\d+\](\S+) \S+ \S+ (\d+) </pcre2>
  <order>srcip,user,action,id</order>
</decoder>



<!-- IIS 5 W3C SMTP log format (Exchange).
  - Examples:
  - #Fields: date time c-ip cs-username s-sitename s-computername s-ip s-port cs-method cs-uri-stem cs-uri-query sc-status sc-win32-status sc-bytes cs-bytes time-taken cs-version cs-host cs(User-Agent) cs(Cookie) cs(Referer)
  - 2006-10-09 14:04:46 69.217.186.117 - SMTPSVC1 MEE-PDC 192.168.X.X 0 xxxx -
  > +hupylaw.hupy.local 500 0 32 23 0 SMTP - - - -
  -->
<decoder name="msexchange">
  <parent>windows-date-format</parent>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^\S+ \S+ SMTPSVC</prematch_pcre2>
  <pcre2 offset="after_parent">^(\S+) \S+ \S+ \S+ \S+ </pcre2>
  <pcre2>\d+ (\S+) \S+ \S+ (\d+) </pcre2>
  <order>srcip, action, id</order>
</decoder>



<!-- Racoon VPN.
  - Extract id (error or info) and ip address whenever possible.
  - 2006-08-08 01:42:09: ERROR: couldn't find the pskey for 222.155.15.88.
  -
  -->
<decoder name="racoon">
  <prematch_pcre2>^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}: </prematch_pcre2>
</decoder>

<decoder name="racoon-failed">
  <parent>racoon</parent>
  <use_own_name>true</use_own_name>
  <prematch_pcre2 offset="after_parent">^ERROR: couldn't find the pskey </prematch_pcre2>
  <pcre2 offset="after_prematch">^for (\S+)</pcre2>
  <order>srcip</order>
</decoder>

<decoder name="racoon-action">
  <parent>racoon</parent>
  <pcre2 offset="after_parent">^([A-Za-z0-9@_-]+?): </pcre2>
  <order>action</order>
</decoder>



<!-- Windows decoder
  - Will extract extra_data (as win source),action (as win category), id,
  - username and computer name (as system_name).
  - Examples:
  - WinEvtLog: Application: INFORMATION(0x00000064): ESENT:
    (no user)(no domain):
  - WinEvtLog: Security: AUDIT_FAILURE(0x000002A9): Security:
    SYSTEM: NT AUTHORITY: The logon to account: xyz    by:
    MICROSOFT_AUTHENTICATION_PACKAGE_V1_0    from workstation: la    failed.
    The error code was: 3221225572
  - WinEvtLog: Security: AUDIT_FAILURE(0x00000211): Security:
    SYSTEM: NT AUTHORITY: Logon Failure:      Reason:     Unknown user
    name or bad password       User Name:  ab      Domain:     cd
    Logon Type: 2       Logon Process:  User32          Authentication
    Package: Negotiate       Workstation Name:   ad
  - WinEvtLog: Security: AUDIT_SUCCESS(538): Security: lac: OSSEC-HM: OSSEC-HM: User Logoff:        User Name:      lac     Domain:         OSSEC-HM        Logon ID:               (0x0,0x7C966E)          Logon Type:     2
  - 2013 Oct 09 17:09:04 WinEvtLog: Application: INFORMATION(1): My Script: (no user): no domain: demo1.foo.example.com: test
  -->
<decoder name="windows">
  <type>windows</type>
  <program_name_pcre2>^WinEvtLog</program_name_pcre2>
</decoder>

<decoder name="windows1">
  <type>windows</type>
  <parent>windows</parent>
  <pcre2 offset="after_parent">^.+: ([A-Za-z0-9@_-]+?)\((\d+?)\): (.+): </pcre2>
  <pcre2>(.+): .+: (\S+): </pcre2>
  <order>status, id, extra_data, user, system_name</order>
  <fts>name, location, system_name</fts>
</decoder>

<decoder name="windows1">
  <type>windows</type>
  <parent>windows</parent>
  <pcre2> Source Network Address: (\S+)</pcre2>
  <order>srcip</order>
</decoder>

<decoder name="windows1">
  <type>windows</type>
  <parent>windows</parent>
  <pcre2> Account Name:[ ]+?([A-Za-z0-9@_-]+?.+)[ ]+?Account</pcre2>
  <order>user</order>
</decoder>

<decoder name="windows1">
  <type>windows</type>
  <parent>windows</parent>
  <pcre2>Account Domain:[ ][ ]+?([A-Za-z0-9@_-].+)[ ][ ]+?Logon ID:</pcre2>
  <order>extra_data</order>
</decoder>


<!-- Windows decoder -NTsyslog format
  - Will extract extra_data (as win source),action (as win category), id,
  - username and computer name (as url).
  - Examples:
  - security[failure] 577 IBM17M\Jeremy Lee  Privileged Service Called:  Server:Security  Service:-  Primary User Name:IBM17M$  Primary Domain:LEETHERNET  Primary Logon ID:(0x0,0x3E7)  Client User Name:Jeremy Lee  Client Domain:IBM17M  Client Logon ID:(0x0,0x1447F)  Privileges:SeSecurityPrivilege
  - security[success] 528 IBM17M\Jeremy Lee  Successful Logon:  User Name:Jeremy Lee  Domain:IBM17M  Logon ID:(0x0,0x3A2E471)  Logon Type:2  Logon Process:User32    Authentication Package:Negotiate  Workstation Name:IBM17M  Logon GUID: {00000000-0000-0000-0000-000000000000}
  -->
<decoder name="windows-ntsyslog">
  <type>windows</type>
  <prematch_pcre2>^security\[[A-Za-z0-9@_-]+?\] \d+? </prematch_pcre2>
  <pcre2>^([A-Za-z0-9@_-]+?)\[([A-Za-z0-9@_-]+?)\] (\d+?) </pcre2>
  <order>extra_data, status, id</order>
</decoder>


<!-- Windows decoder - Snare format.
  - Will extract extra_data (as win source), action (as category), id,
  - username and computer name (as system_name).
  -
  - These logs must be tab-separated (as specified in the Snare format)
  -
  - Examples:
  - Aug 11 11:11:11 xx.org MSWinEventLog  1       System 59221    Thu Aug 11 01:11:11 2006        17      Windows Update Agent    Unknown User
  - Jan 16 05:52:15 hostname.xx.org MSWinEventLog 1
  Security        13049   Tue Jan 16 05:52:15 2007        680     Security
  SYSTEM  User    Success Audit   ACTUATE Account Logon
  Account Used for Logon by: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0
  Account Name:     IUSR_HOSTNAME    Workstation:      ACTUATE
  12653
  - Jan 16 13:02:24 hostname.yy.org MSWinEventLog 1
  Application     14539   Tue Jan 16 13:02:24 2007        1704    SceCli
  Unknown User    N/A     Information     ACTUATE None      Security
  policy in the Group policy objects are applied successfully.    67
  - Jan 16 15:41:37 hostname.zz.org MSWinEventLog 1       System
  15059   Tue Jan 16 15:41:37 2007        10      Print   username User
  Information     HOSTNAME None            Document 76,
  /directory/directory/directory/directory/directory/date/Afilename owned
  by username was printed on hostname_duplex via port hostname_duplex.
  Size in bytes: 19543296; pages printed: 162        361
  -->
<decoder name="windows-snare">
  <type>windows</type>
  <prematch_pcre2>^MSWinEventLog\t\d\t.+\t\d+?\t[A-Za-z0-9@_-]{3}\S+ [A-Za-z0-9@_-]{3} \d{2} \d{2}</prematch_pcre2>
  <pcre2 offset="after_prematch">^:\d{2}:\d{2} \d{4}\t(\d+?)\t(.+)</pcre2>
  <pcre2>\t(.+)\t.+\t(.+)\t(.+)\t</pcre2>
  <order>id, extra_data, user, status, system_name</order>
  <fts>name, id, location, user, system_name</fts>
</decoder>


<!-- Symantec AV decoder.
  - Source: http://www.ossec.net/wiki/index.php/Symantec_Antivirus
  - Examples:
  - 24090D00000A,4,3,7,ACMELABS-SRV2,SYSTEM,,,,,,,16777216,"Update to computer ACMELABS-LU2K3 of virus definition file 81011r succeeded.",0,,0,,,,,0,,,,,,,,,,,,,(IP)-192.168.49.66,ACMELABSav,ACMELABS,,8.1.825
  - 24090D00000F,4,3,7,ACMELABS-SRV2,SYSTEM,,,,,,,16777216,"Update to computer ACMELABS-APPS-BOX4 of virus definition file 81011r succeeded.",0,,0,,,,,0,,,,,,,,,,,,,(IP)-192.168.49.66,ACMELABSav,ACMELABS,,8.1.825
  - 240801012128,5,1,720997,RBLWAP,SYSTEM,Trojan.Zlob,C:\WINDOWS\system32\ld100.tmp,5,4,4,256,570441764,"",0,,0,,0,4254,0,0,0,0,0,0,20060830.022,58100,2,4,0,acme-AVSRV,{579642AA-5A5E-46E1-8613-2289349D1F27},,(IP)-192.168.100.237,acmeav,acme,,8.1.825
  -->
<decoder name="symantec-av">
  <prematch_pcre2>^[A-Za-z0-9@_-]{12},</prematch_pcre2>
  <pcre2 offset="after_prematch">^(\d+?),\d+?,\d+?,(\S+),(.+),</pcre2>
  <order>id, system_name, extra_data</order>
  <fts>name, location, id, system_name, extra_data</fts>
</decoder>


<!-- Symantec Web Security.
  - Source: http://www.ossec.net/wiki/index.php/Symantec_Websecurity
  - Examples:
  - 20070717,30517,1=3,41=SWS-3.0.1.86/vendor-config,100=Version 3.0.6,3=7,2=29
  - 20070717,73556,1=5,100=Logoff due to timeout.,11=1.2.3.4,10=usera,3=1,2=2
    20070717,73559,1=5,11=2.3.4.5,10=userb,3=2,2=1
  -->
<decoder name="symantec-websecurity">
  <prematch_pcre2>^\d{8},\d{3,},</prematch_pcre2>
  <plugin_decoder>SymantecWS_Decoder</plugin_decoder>
</decoder>



<!-- Trend Micro OSCE (Office Scan) decoder.
  - 20090716<;>948<;>TROJ_Generic.DIT<;>25<;>3<;>0<;>C:\Documents and Settings\Administrator\Desktop\HyperSnap 6.02.01_EN\HprSnap6Man.chm<;>
  - 20090716<;>950<;>WORM_DOWNAD.A<;>1<;>3<;>0<;>C:\Documents and Settings\DCS_VM-ICRC-WFBS6\Local Settings\Temporary Internet Files\Content.IE5\9JK3DN67\sitb[1].jpg<;>
  - 20090716<;>951<;>WORM_DOWNAD.A<;>1<;>3<;>0<;>C:\Documents and Settings\Default User\Local Settings\Temporary Internet Files\Content.IE5\9JK3DN67\sitb[1].jpg<;>
  - Date<;>Time<;>Virus name<;>Scan result<;>Scan type<;>Seen<;>Filename<;>
  - We are only extracting the scan result right now.
  -->
<decoder name="trend-osce">
  <prematch_pcre2>^20\d{6}\<;></prematch_pcre2>
  <pcre2 offset="after_prematch">^\d+?\<;>\S+\<;>(\d+?)\<;</pcre2>
  <order>id</order>
</decoder>



<!-- ossec decoder.
  - Deals with ossec internal messages.
  -->
<decoder name="ossec">
  <prematch_pcre2>^ossec: </prematch_pcre2>
  <type>ossec</type>
</decoder>

<decoder name="ossec-logcollector">
  <type>ossec</type>
  <prematch_pcre2>^\d{4}/\d{2}/\d{2} \d{2}:\d{2}:\d{2} ossec-logcollector</prematch_pcre2>
  <pcre2 offset="after_prematch">^\(\d+?\): (.)</pcre2>
  <order>extra_data</order>
</decoder>

<decoder name="ossec-agent">
  <parent>ossec</parent>
  <type>ossec</type>
  <prematch_pcre2 offset="after_parent">^Agent started:</prematch_pcre2>
  <pcre2 offset="after_prematch">^ '(\S+\S)'</pcre2>
  <order>extra_data</order>
  <fts>name, location, extra_data</fts>
</decoder>

<decoder name="ossec-alert1">
   <parent>ossec</parent>
   <prematch_pcre2>^ossec: Alert Level:</prematch_pcre2>
   <plugin_decoder>OSSECAlert_Decoder</plugin_decoder>
</decoder>

<decoder name="ossec-alert">
  <program_name_pcre2>^ossec$</program_name_pcre2>
  <plugin_decoder>OSSECAlert_Decoder</plugin_decoder>
</decoder>

<!-- decoder for active responses as logged by an OSSEC agent or server

- Examples
Sat May  7 03:17:27 CDT 2011 /var/ossec/active-response/bin/host-deny.sh add - 172.16.0.1 1304756247.60385 31151
Sat May  7 03:17:27 CDT 2011 /var/ossec/active-response/bin/firewall-drop.sh add - 172.16.0.1 1304756247.60385 31151
Sat May  7 03:27:57 CDT 2011 /var/ossec/active-response/bin/host-deny.sh delete - 172.16.0.1 1304756247.60385 31151
Sat May  7 03:27:57 CDT 2011 /var/ossec/active-response/bin/firewall-drop.sh delete - 172.16.0.1 1304756247.60385 31151
-->

<decoder name="ar_log">
  <prematch_pcre2>^[A-Za-z0-9@_-]{3} [A-Za-z0-9@_-]+?[ ]+?\d+? \d{2}:\d{2}:\d{2} [A-Za-z0-9@_-]+? \d+? /\S+/active-response</prematch_pcre2>
  <pcre2 offset="after_prematch">/bin/(\S+) (\S+) - (\S+) (\d+?\.\d+?) (\d+)</pcre2>
  <order>action, status, srcip, id, extra_data</order>
</decoder>

<!-- Zeus decoder.
  - Will extract the severity and the srcip/username when available.
  - Examples:
  - [08/Aug/2006:22:32:12 +0100] WARN:admin:Authentication failure, url=/index.cgi, host=xx.yy.com, user=admin
  - [10/Dec/2006:16:59:26 +0000] INFO:Zeus Admin Server running
  -->
<decoder name="zeus">
  <prematch_pcre2>^\[\d{2}/[A-Za-z0-9@_-][A-Za-z0-9@_-][A-Za-z0-9@_-]/\d{4}:\d{2}:\d{2}:\d{2} \S+\] </prematch_pcre2>
  <pcre2 offset="after_prematch"> host=(\S+), </pcre2>
  <order>srcip</order>
</decoder>



<!-- Vmware ESX logs.
  - Will extract the severity and username/ip when available.
  - Examples:
  - [2008-03-09 22:43:35.924 'ha-eventmgr' 84503472 info] Event 2053 : User root@127.0.0.1 logged in
  - [2008-02-05 02:13:18.112 'ha-eventmgr' 95833272 info] Event xyz : User m@1.2.3.4 logged in
  -  [2008-08-26 11:06:16.359 'ha-eventmgr' 20532144 info] Event 285 : Failed login attempt for root@127.0.0.1
  - Aug 25 06:01:10 hostname vmware-hostd[1863]: Accepted password for user root from 127.0.0.1
  - Aug  7 11:05:34 localhost vmware-authd[9709]: login from 172.16.129.78 as 523b717c-4542-f5fc-c006-1644eb8f4330
  - Aug 26 11:42:29 localhost vmware-hostd[1863]: Rejected password for user blablabla from 127.0.0.1
  -->
<decoder name="vmware">
  <prematch_pcre2>^\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3} '\S+' \d+? </prematch_pcre2>
</decoder>

<decoder name="vmware-extra">
  <parent>vmware</parent>
  <pcre2 offset="after_parent">^([A-Za-z0-9@_-]+?)\] \S+ \S+ </pcre2>
  <order>status</order>
</decoder>

<decoder name="vmware-extra">
  <parent>vmware</parent>
  <pcre2 offset="after_regex">^: User ([A-Za-z0-9@_-]+?)@(\S+)</pcre2>
  <pcre2> logged |^: Failed login \w+ for ([A-Za-z0-9_-]+)@(\S+)</pcre2>
  <order>user, srcip</order>
</decoder>

<decoder name="vmware-syslog">
  <program_name_pcre2>vmware</program_name_pcre2>
</decoder>

<decoder name="vmware-success">
  <parent>vmware-syslog</parent>
  <prematch_pcre2>^Accepted|^Rejected</prematch_pcre2>
  <pcre2 offset="after_prematch">^ \S+ for user (\S+) from (\S+)$</pcre2>
  <order>user, srcip</order>
</decoder>

<decoder name="vmware-login">
  <parent>vmware-syslog</parent>
  <prematch_pcre2>^login from </prematch_pcre2>
  <pcre2 offset="after_prematch">^(\S+) as</pcre2>
  <order>srcip</order>
</decoder>



<!-- Solaris BSM
  - Examples:
  - Nov 21 15:12:56 unknown audit: [ID 905220 audit.notice] system booted
    text booting kernel
  - Nov 21 15:16:22 unknown audit: [ID 984917 audit.notice] login - telnet
    failed session 2740580090 by root as root:root from 1.254.168.192
  - failed session 2740580090 by root as root:root from 1.254.168.192
  - ok session 347344759 by 500959152 as root:root from 3.11.8.4 obj
  -->
<decoder name="solaris_bsm">
  <program_name_pcre2>^audit$</program_name_pcre2>
</decoder>

<decoder name="solaris_bsm_session">
  <parent>solaris_bsm</parent>
  <prematch_pcre2> [A-Za-z0-9@_-]+? session \d+? by </prematch_pcre2>
  <pcre2> ([A-Za-z0-9@_-]+) session \d+ by</pcre2>
  <order>status</order>
</decoder>

<decoder name="solaris_bsm_session">
  <parent>solaris_bsm</parent>
  <pcre2 offset="after_regex">^ \S+ as \S+:\S+ from (\S+)</pcre2>
  <order>srcip</order>
</decoder>



<!-- Asterisk logs
  - Examples:
  - Dec 16 18:02:04 asterisk1 asterisk[31774]: NOTICE[31787]:
  chan_sip.c:11242 in handle_request_register: Registration from
  '"503"<sip:503@192.168.1.107>' failed for '192.168.1.137' - Wrong
  password
  -->
<decoder name="asterisk">
  <program_name_pcre2>^asterisk</program_name_pcre2>
</decoder>

<decoder name="asterisk-hijacking">
  <parent>asterisk</parent>
  <prematch_pcre2>^WARNING\[\d+?\]: \S+ in \S+: Don't know </prematch_pcre2>
  <pcre2 offset="after_prematch">^\S+ how to respond via '([A-Za-z0-9@_-]+/\d\.\d/[A-Za-z0-9@_-]+)'</pcre2>
  <order>user</order>
</decoder>

<decoder name="asterisk-denied">
  <parent>asterisk</parent>
  <prematch_pcre2>^NOTICE\[\d+?\]: \S+ in \S+: Registration from </prematch_pcre2>
  <pcre2 offset="after_prematch">^'.+' failed for '(\S+):(\d+?)'|^'.+' failed for '(\S+)'</pcre2>
  <order>srcip,srcport</order>
</decoder>

<decoder name="asterisk-denied2">
  <parent>asterisk</parent>
  <prematch_pcre2>Registration from </prematch_pcre2>
  <pcre2 offset="after_prematch">failed for '(\S+):(\d+?)'|failed for '(\S+)'</pcre2>
  <order>srcip,srcport</order>
</decoder>

<decoder name="asterisk-denied3">
  <parent>asterisk</parent>
  <prematch_pcre2>^NOTICE\[\d+?\]\[[A-Za-z0-9@_-]+?\]: \S+ in \S+: Call from </prematch_pcre2>
  <pcre2 offset="after_prematch">^'\S*' \((\S+):(\d+?)\) to extension '(\S+)' rejected because extension not found in context '(\S+)'\.$</pcre2>
  <order>srcip, srcport, extra_data, extra_data</order>
</decoder>

<decoder name="asterisk-iax-authentication-denied">
  <parent>asterisk</parent>
  <prematch_pcre2>^NOTICE\[\d+\]: \S+ in \S+: Host </prematch_pcre2>
  <pcre2 offset="after_prematch">^(\S+) failed MD5 authentication for (\S+)</pcre2>
  <order>srcip, user</order>
</decoder>

<!-- Cisco IOS
  - Group for Cisco IOS messages.
  - We would need to support multiple formats, but currently we require
  - no service time stamp and no sequence-numbers.
  -
  - Aug 17 17:41:26 xyz.com 681: Aug 17 17:41:24.776 AEST: %SEC-6-IPACCESSLOGS: list 30 denied 124.254.75.141 1 packet
  - Aug 20 11:33:41 RouterName 696: %SYS-5-CONFIG_I: Configured from
  console by admin on vty0 (210.x.x.12)
  - 681: Aug 17 17:41:24.776 AEST: %SEC-6-IPACCESSLOGS:
  - 1348: .Jun 12 18:22:22 UTC: %SYS-5-CONFIG_I:
  - 1348: *Jun 12 18:22:22 UTC: %SYS-5-CONFIG_I:
  - 23: May  3 05:15:25.217 UTC: %SEC-6-IPACCESSLOGP:
  - Possible regex:
  "^%\w+-\d-\w+: |^\S\w\w+ \.\d \d{2}:\S+ \w+: %\w+-\d-\w+:"
  -->
<decoder name="cisco-ios">
  <prematch_pcre2>^%\w+-\d-\w+: </prematch_pcre2>
</decoder>

<decoder name="cisco-ios">
  <program_name />
  <prematch_pcre2>^%\w+-\d-\w+: </prematch_pcre2>
</decoder>


<!-- Cisco IOS
  - Will extract the action, srcip, srcport, dstip and dstport
  - Samples:
  -
  - %SEC-6-IPACCESSLOGP: list 102 denied tcp 10.0.6.56(3067) -> 172.36.4.7(139), 1 packet
  - %SEC-6-IPACCESSLOGP: list 199 denied tcp 10.0.61.108(1477) -> 10.0.127.20(445), 1 packet
  -->
<decoder name="cisco-ios-acl">
  <parent>cisco-ios</parent>
  <type>firewall</type>
  <prematch_pcre2>^%SEC-6-IPACCESSLOGP: </prematch_pcre2>
  <pcre2 offset="after_prematch">^list \S+ (\w+) (\w+) </pcre2>
  <pcre2>(\S+)\((\d+)\) -> (\S+)\((\d+)\),</pcre2>
  <order>action, protocol, srcip, srcport, dstip, dstport</order>
</decoder>


<!-- Cisco IOS IDS/IPS module
  - Will extract the id, srcip, srcport, dstip and dstport
  - Sep  1 10:25:29 10.10.10.1 %IPS-4-SIGNATURE: Sig:3051 Subsig:1 Sev:4 TCP Connection Window Size DoS [192.168.100.11:51654 -> 10.10.10.10:4444]
  - Sep  1 10:25:29 10.10.10.1 %IPS-4-SIGNATURE: Sig:3051 Subsig:1 Sev:4 TCP Connection Window Size DoS [192.168.100.11:60797 -> 10.10.10.10:80]
  - Sep  1 10:25:29 10.10.10.1 %IPS-4-SIGNATURE: Sig:5123 Subsig:2 Sev:5 WWW IIS Internet Printing Overflow [192.168.100.11:60797 -> 10.10.10.10:80]
  -->
<decoder name="cisco-ios-ids">
  <parent>cisco-ios</parent>
  <type>ids</type>
  <prematch_pcre2>^%IPS-4-SIGNATURE: </prematch_pcre2>
  <pcre2 offset="after_prematch">^Sig:(\d+) .+\[(\S+):(\d+) -> </pcre2>
  <pcre2>(\S+):(\d+)\]</pcre2>
  <order>id, srcip, srcport, dstip, dstport</order>
  <fts>name, id, srcip, dstip</fts>
  <ftscomment>First time Cisco IOS IDS/IPS module rule fired.</ftscomment>
</decoder>


<!-- Cisco IOS
  - Extracts the ID of cisco ios messages.
  -->
<decoder name="cisco-ios-generic">
  <parent>cisco-ios</parent>
  <pcre2>^(%\w+-\d-\w+): </pcre2>
  <order>id</order>
</decoder>



<!-- Checkpoint via syslog decoder.
  - Does not currently handle all types of Checkpoint events.
  - Checkpoint NG(X)/FW-1 logs via (Linux) syslog
  - Ex. fw log -ftnp fw.log | logger -t Checkpoint
  -
  - fw log :
  -         -f select current log file
  -         -t tail file
  -         -n use ip instead of name
  -         -p use port number instead of name
  -
  -         -l add date before timestamp
  -            Use of -l changes log format slightly
  -
  -         -g without : and ; delimiters
  -            use of -g significantly changes log format
  -            this decoder is incompatible with -g
  -
  - logger :
  -         -t <tag> prepends "tag: " to log entry
  -        the tag here must match "program name" in the decoder
  -
  - Examples:
  -
  - Checkpoint: 21Aug2007 12:00:00 accept 10.10.10.2 >eth0 rule: 100; rule_uid:
{00000000-0000-0000-0000-000000000000}; service_id: nbdatagram; src:
10.10.10.3; dst: 10.10.10.255; proto: udp; product: VPN-1 & FireWall-1;
service: 138; s_port: 138;
  -
  - Checkpoint: 13:00:00 accept 10.10.10.2 >eth0 rule: 101; rule_uid:
{00000000-0000-0000-0000-000000000000}; service_id: http; src: 10.10.10.3; dst:
10.1.2.3; proto: tcp; product: VPN-1 & FireWall-1; service: 80; s_port: 1111;
  -
  - Checkpoint: 21Aug2007 14:49:26 drop   10.10.10.1 >eth4 rule: 102; rule_uid:
{00000000-0000-0000-0000-000000000000}; ICMP: Echo Request; src: 10.10.10.2;
dst: 10.10.10.3; proto: icmp; ICMP Type: 8; ICMP Code: 0; product: VPN-1 &
FireWall-1;
  -
  - Checkpoint:  3Apr2008 15:02:15 monitor 10.10.10.3 >eth2 Attack Info: Line
in HTTP request too long; attack: Malformed HTTP; src: 10.10.10.4; dst:
10.10.10.5; proto: tcp; product: SmartDefense; service: 111; s_port: 222;
  -->

<!-- \s+\S+ \d{2}:\d{2}:\d{2} (\w+) \S+ \p\S+ rule: -->
<decoder name="checkpoint-syslog">
  <program_name_pcre2>^Checkpoint</program_name_pcre2>
  <prematch_pcre2>^[ ]+?\S+ \d{2}:\d{2}:\d{2} </prematch_pcre2>
</decoder>

<decoder name="checkpoint-syslog-fw">
  <parent>checkpoint-syslog</parent>
  <type>firewall</type>
  <prematch_pcre2 offset="after_parent">^drop|^accept|^reject</prematch_pcre2>
  <pcre2 offset="after_parent">^([A-Za-z0-9@_-]+)[ ]+\S+ >\S+ rule:.+</pcre2>
  <pcre2>src: (\S+); dst: (\S+); proto: (\S+);</pcre2>
  <order>action,srcip,dstip,protocol</order>
</decoder>

<decoder name="checkpoint-syslog-fw">
  <parent>checkpoint-syslog</parent>
  <type>firewall</type>
  <pcre2 offset="after_regex">service: (\d+); s_port: (\d+);</pcre2>
  <order>dstport,srcport</order>
</decoder>

<decoder name="checkpoint-syslog-ids">
  <parent>checkpoint-syslog</parent>
  <type>ids</type>
  <prematch_pcre2 offset="after_parent">^monitor|^drop</prematch_pcre2>
  <pcre2 offset="after_prematch">attack: (.+); </pcre2>
  <pcre2>src: (\S+); dst: (\S+); </pcre2>
  <pcre2>proto: (\S+);</pcre2>
  <order>extra_data, srcip, dstip, protocol</order>
  <fts>name, extra_data, srcip, dstip</fts>
  <ftscomment>First time Checkpoint rule fired.</ftscomment>
</decoder>



<!-- Microsoft Windows 2003 ipv4, 2008 ipv4/ipv6 DHCP decoder for OSSEC
  -  Author: phishphreek@gmail.com
  -->

<!--
  -  Server 2008 DHCP IPv4 Decoder (must go first)
  -  ID,Date,Time,Description,IP Address,Host Name,MAC Address,User Name, TransactionID, QResult,Probationtime, CorrelationID.
  -  24,3/10/2009,0:00:46,Database Cleanup Begin,,,,
  -  0,3/10/2009,0:00:46,DNS Update Request,201.10.168.192,OPS03W034.,,
-->

<decoder name="ms-dhcp-ipv4">
  <prematch_pcre2>^\d{2},\d+?/\d+?/\d{4},\d+?:\d+?:\d+?,|</prematch_pcre2>
  <prematch_pcre2>^\d{2},\d+?/\d+?/\d{2},\d+?:\d+?:\d+?,</prematch_pcre2>
  <pcre2>^(\d{2}),\d+?/\d+?/\d{2,},\d+?:\d+?:\d+?,([A-Za-z0-9@_-]+?),(\S+)</pcre2>
  <order>id,extra_data,srcip</order>
</decoder>

<!--
  -  Server 2008 DHCP IPv6 Decoder (must go second)
  -  ID,Date,Time,Description,IPV6 Address,Host Name,Error Code, Duid Length, Duid Bytes(Hex),User Name.
-->
<decoder name="ms-dhcp-ipv6">
  <prematch_pcre2>^\d{5},\d{2}/\d{2}/\d{2},\d{2}:\d{2}:\d{2},</prematch_pcre2>
  <pcre2>^(\d{5}),</pcre2>
  <order>id</order>
</decoder>


<!-- OpenBSD kernel messages -->
<decoder name="bsd_kernel">
  <program_name_pcre2>^/bsd</program_name_pcre2>
</decoder>

<decoder name="bsd_arp">
  <parent>bsd_kernel</parent>
  <prematch_pcre2 offset="after_parent">^arp </prematch_pcre2>
  <pcre2 offset="after_prematch"> for (\S+) by (\S+) on \S+</pcre2>
  <order>dstip, extra_data</order>
</decoder>

<!-- OpenBSD deluser
  -  2014-02-21T10:22:55.134355-05:00 arrakis userdel[23023]: user removed: name=dac
-->

<decoder name="open-userdel">
  <program_name_pcre2>userdel</program_name_pcre2>
  <pcre2>user removed: name=(\S+)$</pcre2>
  <order>srcuser</order>
</decoder>



<!-- OpenBSD mountd decoder
- Apr 11 20:01:02 ix mountd[11618]: Refused mount RPC from host 192.168.17.10 port 45659
-->

<decoder name="mountd">
  <program_name_pcre2>^mountd</program_name_pcre2>
</decoder>

<decoder name="mountd-host">
  <parent>mountd</parent>
  <prematch_pcre2>from host </prematch_pcre2>
  <pcre2 offset="after_prematch">(\S+) port \d+?$</pcre2>
  <order>srcip</order>
</decoder>


<!-- nss ldap decoders
- Jun 26 08:19:25 servername sh: nss_ldap: reconnecting to LDAP server (sleeping 32 seconds)...
- Aug 16 10:58:12 client nscd: nss_ldap: failed to bind to LDAP server ldap://ldap.example.com: Can't contact LDAP server
-->
<!--
<decoder name="nss-ldap">
  <program_name_pcre2>^sh$|^nscd$</program_name_pcre2>
  <prematch_pcre2>^nss_ldap</prematch_pcre2>
</decoder>

<decoder name="ldap-server">
  <parent>nss-ldap</parent>
  <prematch_pcre2> server </prematch_pcre2>
  <pcre2 offset="after_prematch">ldap://(\S+):</pcre2>
  <order>system_name</order>
</decoder>
-->



<!-- OpenBSD groupdel
  - May 28 09:15:43 ix groupdel[25984]: group deleted: name=_dbus
-->
<decoder name="groupdel">
  <program_name_pcre2>groupdel</program_name_pcre2>
  <pcre2>^group deleted: name=(\S+)$</pcre2>
  <order>extra_data</order>
</decoder>


<!-- Portsentry -->
<decoder name="portsentry">
  <program_name_pcre2>^portsentry</program_name_pcre2>
</decoder>

<decoder name="portsentry-attackalert">
  <parent>portsentry</parent>
  <prematch_pcre2>attackalert: Connect from host: </prematch_pcre2>
  <pcre2 offset="after_prematch">(\S+)/\S+ to (\S+) port: (\d+?)$</pcre2>
  <order>srcip,protocol,dstport</order>
</decoder>

<decoder name="portsentry-blocked">
  <parent>portsentry</parent>
  <prematch_pcre2>is already blocked\. Ignoring$</prematch_pcre2>
  <pcre2>Host: (\S+) is</pcre2>
  <order>srcip</order>
</decoder>


<!-- Clamav and Freshclam decoder
  -  Nov  5 22:59:19 ix freshclam[32349]: Incremental update failed, trying to download daily.cvd
-->
<decoder name="clamd">
  <program_name_pcre2>^clamd</program_name_pcre2>
</decoder>

<decoder name="freshclam">
  <program_name_pcre2>^freshclam</program_name_pcre2>
</decoder>


<!-- OpenLDAP decoder.
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 fd=64 ACCEPT from IP=10.10.248.27:33957 (IP=10.10.241.77:389)
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 op=0 BIND dn="uid=example,ou=People,dc=example,dc=com" method=128
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 op=0 RESULT tag=97 err=49 text=
        ^- Login Failed
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 op=1 BIND dn="uid=example,ou=People,dc=example,dc=com" method=128
        ^- Login Retried
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 op=1 RESULT tag=97 err=0 text=
        ^- Login Successful
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 op=2 UNBIND
  - Jan 11 09:26:57 hostname slapd[20872]: conn=999999 fd=64
        ^- Connection closed

  -->
<decoder name="openldap">
    <program_name_pcre2>^slapd</program_name_pcre2>
    <accumulate/>
</decoder>

<decoder name="openldap-connect">
    <parent>openldap</parent>
    <prematch_pcre2>ACCEPT</prematch_pcre2>
    <pcre2>^conn=(\d+) fd=\d+ ACCEPT from IP=(\S+):</pcre2>
    <order>id, srcip</order>
    <accumulate/>
</decoder>

<decoder name="openldap-bind">
    <parent>openldap</parent>
    <prematch_pcre2>BIND </prematch_pcre2>
    <pcre2>^conn=(\d+) op=\d+ BIND dn="[A-Za-z0-9@_-]+=([A-Za-z0-9@_-]+),</pcre2>
    <order>id, dstuser</order>
    <accumulate/>
</decoder>

<decoder name="openldap-result">
    <accumulate/>
    <parent>openldap</parent>
    <prematch_pcre2> RESULT </prematch_pcre2>
    <pcre2>^conn=(\d+) op=\d+ RESULT </pcre2>
    <order>id</order>
</decoder>

<!-- NTP decoder
  - gorilla ntpd[27379]: bad sensor nmea0
  - tiny ntpd[25875]: bad peer 192.168.1.233 (192.168.1.233)
  - gorilla ntpd[29719]: bind on 192.168.1.233 failed, skipping: Can't assign requested address
  - ix ntpd[8392]: bind on 192.168.17.9 failed, skipping: Address already in use
  - ix ntpd[11685]: bad peer from pool pool.ntp.org (64.73.32.135)
  - richese ntpd[3465]: bad peer ix (192.168.17.9)
  - ix ntpd[11685]: bad peer from pool pool.ntp.org (69.50.219.51)
  - ix ntpd[7045]: recvmsg 192.168.17.17: Connection refused
  - ix ntpd[29411]: 2 out of 3 peers valid
  - bridge ntpd[5877]: logconfig: illegal argument  - ignored
  - bridge ntpd[5902]: offset 0.000000 sec freq 0.000 ppm error 0.000011 poll 6
-->
<decoder name="ntpd">
  <program_name_pcre2>^ntpd</program_name_pcre2>
</decoder>

<decoder name="ntpd-bad-peer">
  <parent>ntpd</parent>
  <prematch_pcre2 offset="after_parent">^bad peer </prematch_pcre2>
  <pcre2>^bad peer \S+ \((\S+)\)$|^bad peer from pool \S+ \((\S+)\)$</pcre2>
  <order>srcip</order>
</decoder>

<decoder name="ntpd-recvmsg">
  <parent>ntpd</parent>
  <pcre2>^recvmsg (\S+):</pcre2>
  <order>dstip</order>
</decoder>

<!-- Auditd
163
164   - Will extract action, id, status, extra_data, srcip
165   - Author and (c): Michael Starks, 2011
166   - Future enhancements should ensure that all log samples regress properly due to the complexity of these decoders
167   - Examples:

<!-- CentOS 5.5 -->
type=USER_ACCT msg=audit(1310592861.936:1222): user pid=24675 uid=0 auid=501 ses=188 subj=system_u:system_r:unconfined_t:s0 msg='op=PAM:accounting acct="username" exe="/usr/bin/sudo" (hostname=?, addr=?, terminal=pts/5 res=success)'
type=CRED_ACQ msg=audit(1305666154.831:51859): user pid=21250 uid=0 auid=4294967295 subj=system_u:system_r:unconfined_t:s0-s0:c0.c1023 msg='PAM: setcred acct="username" : exe="/usr/sbin/sshd" (hostname=lala.example.com, addr=172.16.0.1, terminal=ssh res=success)'
type=CRED_ACQ msg=audit(1273182001.226:148635): user pid=29770 uid=0 auid=4294967295 subj=system_u:system_r:crond_t:s0-s0:c0.c1023 msg='PAM: setcred acct="root" : exe="/usr/sbin/crond" (hostname=?, addr=?, terminal=cron
type=USER_AUTH msg=audit(1305666163.690:51871): user pid=21269 uid=0 auid=500 subj=user_u:system_r:unconfined_t:s0 msg='PAM: authentication acct="root" : exe="/bin/su" (hostname=?, addr=?, terminal=pts/0 res=success)'
type=USER_ACCT msg=audit(1306939201.750:67934): user pid=4401 uid=0 auid=4294967295 subj=system_u:system_r:crond_t:s0-s0:c0.c1023 msg='PAM: accounting acct="root" : exe="/usr/sbin/crond" (hostname=?, addr=?, terminal=cron res=success)'
type=CRED_ACQ msg=audit(1306939201.751:67935): user pid=4401 uid=0 auid=4294967295 subj=system_u:system_r:crond_t:s0-s0:c0.c1023 msg='PAM: setcred acct="root" : exe="/usr/sbin/crond" (hostname=?, addr=?, terminal=cron res=success)'
type=USER_START msg=audit(1306939201.756:67937): user pid=4401 uid=0 auid=0 subj=system_u:system_r:crond_t:s0-s0:c0.c1023 msg='PAM: session open acct="root" : exe="/usr/sbin/crond" (hostname=?, addr=?, terminal=cron res=success)'
type=USER_CHAUTHTOK msg=audit(1304523288.952:37394): user pid=7258 uid=0 auid=500 subj=user_u:system_r:unconfined_t:s0 msg='op=change password id=505 exe="/usr/bin/passwd" (hostname=?, addr=?, terminal=pts/1 res=success)'

<!-- Unknown source -->
type=USER_ACCT msg=audit(1310592861.936:1222): user pid=24675 uid=0 auid=501 ses=188 subj=system_u:system_r:unconfined_t:s0 msg='op=PAM:accounting acct="username" exe="/usr/bin/sudo" (hostname=?, addr=?, terminal=pts/5 res=success)'

<!-- Ubuntu 10.04 LTS -->
type=SYSCALL msg=audit(1307045440.943:148): arch=c000003e syscall=59 success=yes exit=0 a0=de1fa8 a1=de23a8 a2=dc3008 a3=7fff1db3cc60 items=2 ppid=11719 pid=12140 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts8 ses=4294967295 comm="wget" exe="/tmp/wget" key="webserver-watch-tmp"
type=SYSCALL msg=audit(1307045820.403:151): arch=c000003e syscall=59 success=no exit=-13 a0=de24c8 a1=de2408 a2=dc3008 a3=7fff1db3cc60 items=1 ppid=11719 pid=12347 auid=4294967295 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts8 ses=4294967295 comm="bash" exe="/bin/bash" key=(null)
type=SYSCALL msg=audit(1306939143.715:67933): arch=40000003 syscall=94 success=yes exit=0 a0=5 a1=180 a2=8ebd360 a3=8ec4978 items=1 ppid=4383 pid=4388 auid=500 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=8038 comm="less" exe="/usr/bin/less" subj=user_u:system_r:unconfined_t:s0 key="perm_mod"
type=USER_ROLE_CHANGE msg=audit(1280266360.845:51): user pid=1978 uid=0 auid=500 subj=system_u:system_r:local_login_t:s0-s0:c0.c1023 msg='pam: default-context=user_u:system_r:unconfined_t:s0 selected-context=user_u:system_r:unconfined_t:s0: exe="/bin/login" (hostname=?, addr=?, terminal=tty1 res=success)'
type=PATH msg=audit(1306967989.163:119): item=0 name="./ls" inode=261813 dev=fb:00 mode=0100755 ouid=0 ogid=0 rdev=00:00

<!-- Will not decode due to null name, that's OK -->
type=PATH msg=audit(1273924468.947:179534): item=0 name=(null) inode=424783 dev=fd:07 mode=0100640 ouid=0 ogid=502 rdev=00:00 obj=user_u:object_r:file_t:s0

-->

<decoder name="auditd">
  <prematch_pcre2>^type=</prematch_pcre2>
</decoder>

<!-- SELinux -->
<decoder name="auditd-selinux">
  <parent>auditd</parent>
  <prematch_pcre2 offset="after_parent">^AVC </prematch_pcre2>
  <pcre2 offset="after_parent">^(AVC) msg=audit\(\d{10}\.\d{3}:(\d+?)\): avc:  (\S+)  \{ .+ \} for  pid=\d+? comm="(\S+)" path="\S+" dev=\S+ ino=\d+? scontext=\S+ tcontext=\S+ tclass=\S+$</pcre2>
  <order>action,id,status,extra_data</order>
</decoder>

<!-- syscall -->
<decoder name="auditd-syscall">
  <parent>auditd</parent>
  <prematch_pcre2 offset="after_parent">^SYSCALL </prematch_pcre2>
  <pcre2 offset="after_parent">^(SYSCALL) msg=audit\(\d{10}\.\d{3}:(\d+?)\): arch=\w+ syscall=\d+ success=(\S+) exit=\S+ a0=\w+ a1=\w+ a2=\w+ a3=\w+ items=\d+ ppid=\d+ pid=\d+ auid=\d+ uid=\d+ gid=\d+ euid=\d+ suid=\d+ fsuid=\d+ egid=\d+ sgid=\d+ fsgid=\d+ tty=\S+ ses=\d+ comm="\S+" exe="(.+?)"</pcre2>
  <order>action,id,status,extra_data</order>
</decoder>

<!-- config -->
<decoder name="auditd-config">
  <parent>auditd</parent>
  <prematch_pcre2 offset="after_parent">^CONFIG_CHANGE </prematch_pcre2>
  <pcre2 offset="after_parent">^(CONFIG_CHANGE) msg=audit\(\d{10}\.\d{3}:(\d+?)\): auid=\d+? ses=\d+? op=".+" path="(.+)" key="\S+" list=\d+? res=\d+?$</pcre2>
  <order>action,id,extra_data</order>
</decoder>

<!-- path (will only decode if name is not null)-->
<decoder name="auditd-path">
  <parent>auditd</parent>
  <prematch_pcre2 offset="after_parent">^PATH </prematch_pcre2>
  <pcre2 offset="after_parent">^(PATH) msg=audit\(\d{10}\.\d{2}:(\d+?)\): item=\d+? name="(.+)" inode=\d+? dev=\S+ mode=\d+? ouid=\d+? ogid=\d+? rdev=\S+</pcre2>
  <order>action,id,extra_data</order>
</decoder>

<!-- user-related -->
<decoder name="auditd-user">
  <parent>auditd</parent>
  <pcre2 offset="after_parent">^(USER_\S+) msg=audit\(\d{10}\.\d{3}:(\d+?)\): user pid=\d+? uid=\d+? auid=\d+|</pcre2>
  <pcre2>^(CRED_\S+) msg=audit\(\d{10}\.\d{3}:(\d+?)\): user pid=\d+? uid=\d+? auid=\d+</pcre2>
  <order>action,id</order>
</decoder>

<decoder name="auditd-user">
  <parent>auditd</parent>
  <pcre2 offset="after_regex"> acct="(.+)" : exe="(.+)" \(hostname=\S+, addr=(\S+), terminal=\S+$</pcre2>
  <order>user,extra_data,srcip</order>
</decoder>

<decoder name="auditd-user">
  <parent>auditd</parent>
  <pcre2 offset="after_regex"> ses=\d+? subj=\S+ msg='.+ acct="(.+)" exe="(.+)" hostname=\S+ addr=(\S+) terminal=\S+ res=(\S+)$</pcre2>
  <order>user,extra_data,srcip,status</order>
</decoder>

<decoder name="auditd-user">
  <parent>auditd</parent>
  <pcre2 offset="after_regex"> subj=\S+ msg='.+ acct="(.+)" :*[ ]*?exe="(.+)" \(hostname=\S+, addr=(\S+), terminal=\S+ res=(\S+)\)'$</pcre2>
  <order>user,extra_data,srcip,status</order>
</decoder>

<decoder name="auditd-user">
  <parent>auditd</parent>
  <pcre2 offset="after_regex"> subj=\S+ msg='.+ exe="(.+)" \(hostname=\S+, addr=(\S+), terminal=\S+ res=(\S+)\)'$</pcre2>
  <order>extra_data,srcip,status</order>
</decoder>

<!--
mptscsih \ mptbase decoder

Description: module for SCSI controllers.

Examples:
[ 5008.286061] mptscsih: ioc0: task abort: FAILED (rv=2003) (sc=ffff88007a8a9f00)

[ 6498.769248] mptbase: ioc0: RAID STATUS CHANGE for PhysDisk 1 id=8
[ 6498.769252] mptbase: ioc0:   PhysDisk is now failed, out of sync

[ 6498.775783] mptbase: ioc0: RAID STATUS CHANGE for VolumeID 0
[ 6498.775788] mptbase: ioc0:   volume is now degraded, enabled
-->
<decoder name="mptscsih-1">
  <parent>iptables</parent>
  <prematch_pcre2>^\[ \d+\.\d+\] mptscsih: </prematch_pcre2>
  <pcre2>^\[ \d+\.\d+\] (\w+): (\w+): task abort: (\w+)</pcre2>
  <order>id,data,status</order>
</decoder>

<decoder name="mptbase-1">
  <parent>iptables</parent>
  <prematch_pcre2>^\[ \d+\.\d+\] mptbase: </prematch_pcre2>
  <pcre2>^\[ \d+\.\d+\] (\w+): (\w+):[ ]+[A-Za-z0-9@_-]+ is now (\w+), (\D+)$</pcre2>
  <order>id,data,action,status</order>
</decoder>

<!-- Grandstream HT502 VoIP gateway decoder
Author and (c): Michael Starks, 2014 -->

<!-- HT502: [00:0B:82:14:5B:94] Transport error (-1) for transaction 2677 -->

<decoder name="grandstream-ata">
 <prematch_pcre2>^HT286: \[\w\w:\w\w:\w\w:\w\w:\w\w:\w\w\][()*+,.:;\<=>?\[\]!"'#%&$|{}-]*?.+[()*+,.:;\<=>?\[\]!"'#%&$|{}-]* |</prematch_pcre2>
 <prematch_pcre2>^HT502: \[\w\w:\w\w:\w\w:\w\w:\w\w:\w\w\][()*+,.:;\<=>?\[\]!"'#%&$|{}-]*?.+[()*+,.:;\<=>?\[\]!"'#%&$|{}-]* |</prematch_pcre2>
 <prematch_pcre2>^HT503: \[\w\w:\w\w:\w\w:\w\w:\w\w:\w\w\][()*+,.:;\<=>?\[\]!"'#%&$|{}-]*?.+[()*+,.:;\<=>?\[\]!"'#%&$|{}-]* </prematch_pcre2>
</decoder>

<decoder name="grandstream-registration">
 <parent>grandstream-ata</parent>
 <prematch_pcre2>Received </prematch_pcre2>
 <pcre2 offset="after_prematch">^(\d+) response for transaction (\d+?)\(([A-Za-z0-9@_-]+)\)$</pcre2>
 <order>status, id, action</order>
</decoder>

<decoder name="grandstream-fts-registered">
 <parent>grandstream-ata</parent>
 <prematch_pcre2>Account </prematch_pcre2>
 <pcre2 offset="after_prematch">^(\d+) (registered), tried \d+; Next registration in \d+ seconds \(\d+/\d+\) on (.+)$</pcre2>
 <order>id, status, extra_data</order>
 <fts>name, location, extra_data</fts>
</decoder>

<decoder name="grandstream-incoming-cid">
 <parent>grandstream-ata</parent>
 <prematch_pcre2>Vinetic::</prematch_pcre2>
 <pcre2 offset="after_prematch">^(startRing) with CID, Attempting to deliver CID (\d+) on port \d+$</pcre2>
 <order>action, id</order>
</decoder>

<decoder name="grandstream-outgoing-call">
 <parent>grandstream-ata</parent>
 <pcre2 offset="after_parent">^(Dialing) (\d+)$</pcre2>
 <order>action, id</order>
</decoder>


<!-- apparmor
  - Jun 24 10:35:29 hostname kernel: [49787.970285] audit: type=1400 audit(1403598929.839:88986): apparmor="ALLOWED" operation="getattr" profile="/usr/sbin/dovecot//null-1//null-2//null-4a6" name="/home/admin/mails/new/" pid=19973 comm="imap" requested_mask="r" denied_mask="r" fsuid=1003 ouid=1003
  - Jul 14 11:03:47 hostname kernel: [ 8665.951930] type=1400 audit(1405328627.702:54): apparmor="DENIED" operation="open" profile="/usr/bin/evince" name="/etc/xfce4/defaults.list" pid=16418 comm="evince" requested_mask="r" denied_mask="r" fsuid=1000 ouid=0
  - Jun 16 17:37:39 hostname kernel: [891880.587623] audit: type=1400 audit(1402933059.038:1681857): apparmor="ALLOWED" operation="exec" profile="/usr/sbin/dovecot//null-1fde//null-1fdf" name="/usr/lib/dovecot/pop3-login" pid=13903 comm="dovecot" requested_mask="x" denied_mask="x" fsuid=0 ouid=0 target="/usr/sbin/dovecot//null-1fde//null-1fdf//null-6b18"
  - Jun 16 17:37:39 hostname kernel: [891880.587957] audit: type=1400 audit(1402933059.038:1681858): apparmor="ALLOWED" operation="open" profile="/usr/sbin/dovecot//null-1fde//null-1fdf//null-6b18" name="/usr/lib/dovecot/libdovecot-login.so.0.0.0" pid=13903 comm="pop3-login" requested_mask="r" denied_mask="r" fsuid=0 ouid=0
  - Jun 16 17:37:39 hostname kernel: [891880.587976] audit: type=1400 audit(1402933059.038:1681859): apparmor="ALLOWED" operation="getattr" profile="/usr/sbin/dovecot//null-1fde//null-1fdf//null-6b18" name="/usr/lib/dovecot/libdovecot-login.so.0.0.0" pid=13903 comm="pop3-login" requested_mask="r" denied_mask="r" fsuid=0 ouid=0
  - Jun 16 17:37:39 hostname kernel: [891880.587989] audit: type=1400 audit(1402933059.038:1681860): apparmor="ALLOWED" operation="file_mmap" profile="/usr/sbin/dovecot//null-1fde//null-1fdf//null-6b18" name="/usr/lib/dovecot/libdovecot-login.so.0.0.0" pid=13903 comm="pop3-login" requested_mask="mr" denied_mask="mr" fsuid=0 ouid=0
  - Jun 23 20:46:15 hostname kernel: [   11.103248] audit: type=1400 audit(1403549175.177:2): apparmor="STATUS" operation="profile_load" name="/sbin/klogd" pid=2185 comm="apparmor_parser"
  - Jun 16 17:37:39 hostname kernel: [891880.587989] audit: type=1400 audit(1314853822.672:33649): apparmor="DENIED" operation="mknod" parent=27250 profile="/usr/lib/apache2/mpm-prefork/apache2//example.com" name="/usr/share/wordpress/1114140474e5f13bea68a4.tmp" pid=27289 comm="apache2" requested_mask="c" denied_mask="c" fsuid=33 ouid=33
  - Jun 16 17:37:39 hostname kernel: [891880.587989] audit: type=1400 audit(1315353795.331:33657): apparmor="DENIED" operation="exec" parent=14952 profile="/usr/lib/apache2/mpm-prefork/apache2//example.com" name="/usr/lib/sm.bin/sendmail" pid=14953 comm="sh" requested_mask="x" denied_mask="x" fsuid=33 ouid=0
-->

<decoder name="apparmor">
  <parent>iptables</parent>
  <prematch_pcre2> apparmor=</prematch_pcre2>
  <pcre2> apparmor="(\S+)" operation="(\S+)"</pcre2>
  <order>status, extra_data</order>
</decoder>

<!-- unix_chkpwd
  - Jul 21 07:40:29 localhost unix_chkpwd[15804]: password check failed for user (username)
-->
<decoder name="unix_chkpwd">
  <program_name_pcre2>^unix_chkpwd</program_name_pcre2>
</decoder>

<!--Jul 21 07:40:29 localhost unix_chkpwd[15804]: password check failed for user (username)-->
<decoder name="chkpwd-user">
  <parent>unix_chkpwd</parent>
  <pcre2 offset="after_parent">user \(([A-Za-z0-9@_-]+)\)$</pcre2>
  <order>srcuser</order>
</decoder>

<!-- Barracuda S&VF Email Logs
Examples:
May 14 03:31:21 mx1.example.org inbound/pass1: mail-88-66.reachmail.net[216.55.88.66] 1400074281-06f4a338c037a90001-TkCAQV 1400074281 1400074283 RECV errors@mail-88-68.reachmail.net eteixeira@example.net 2 12 -
May 15 14:09:17 mx1.example.org inbound/pass1: host.limitless-servers.com[192.208.186.41] 1400198954-06f4a338c062640001-BkZagu 1400198954 1400198958 SCAN - heartattackbreakthrough@ridchanceofhrtattk.us en@example.org - 2 74 ridchanceofhrtattk.us SZ:2557 SUBJ:THE #1 Trick to Prevent Heart-Attacks Revealed???
May 16 10:12:29 mx1.example.org inbound/pass1: kumarafoundation.hestoe.com[208.123.118.114] 1400271149-06f4a338c07a210001-QwTJwG 1400271149 1400271151 SCAN - EzekielMack@kumarafoundation.hestoe.com ctakesue@example.org - 2 74 hestoe.com SZ:1917 SUBJ:Bad Economy, Bad Rates - Get An Auto Insurance Quotes Today
May 13 01:20:44 mx1.example.org scan: salmon.emxp002.net[174.123.35.182] 1399980039-06f4a338c019db0001-ZAPlzU 1399980040 1399980045 SCAN - errors@mermaid.emxp002.net PTAUA@HINGYCA.ORG 1.636 0 0 - SZ:86808 SUBJ:ATTN PASILA: URGENT FUNDING AVAILABLE
May 14 09:39:30 mx1.example.org scan: mc.eau.lormaneducation.com[64.198.99.4] 1400096370-06f4a338c040390001-vQoliC 1400096370 1400096372 SCAN - bounce-201405143661297864@mc.eau.lormaneducation.com tmoriyasu@dod.hawaii.gov 0.401 0 0 - SZ:22001 SUBJ:Contractor's Dilemma of Dealing With Bad Plans and Specs - OnDemand Webinar
May 16 10:56:04 mx1.example.org scan: smtp133.elabs13.com[74.116.235.133] 1400273757-06f4a338c07b490001-CBNzJg 1400273757 1400273765 SCAN - newsletter@email.cnbc.com tcolwell@example.net 0.402 0 0 - SZ:26609 SUBJ:=?utf-8?Q?"Failure=20to=20Recall:=20Investigating=20GM"=20Premier?==?utf-8?Q?es=20Sunday=2010p=20ET/PT?=
Jul 26 10:39:36 mx1.example.org outbound/smtp: 127.0.0.1 1406407176-06f4a35b4d10f2c0001-EGYtgK 0 0 SEND - 3 A90EBA1F1BA connect to dnvrco-pub-iedge-vip.email.rr.com[107.14.73.70]: server refused mail service
Jul 26 13:38:16 mx1.example.org outbound/smtp: 127.0.0.1 1406248798-06f4a35b4de6bd0001-3QeedR 0 0 SEND - 3 68EC0A1F1A3 Name service error for name=conference.preventchildabusetexas.org type=MX: Host not found, try again
Jul 26 13:57:56 mx1.example.org outbound/smtp: 127.0.0.1 1406297159-06f4a35b4df2000001-PDxQZ2 0 0 SEND - 3 A194BA1F1AC connect to qw.eau.lormanwebinars.com[63.232.201.60]: Connection refused
-->

<decoder name="barracuda-svf-email">
  <program_name_pcre2>^inbound/pass|^scan|^outbound/smtp</program_name_pcre2>
</decoder>

<decoder name="barracuda-svf1">
  <parent>barracuda-svf-email</parent>
  <prematch_pcre2>^\S+\[\S+\]|</prematch_pcre2>
  <prematch_pcre2>^\S+</prematch_pcre2>
  <pcre2>^\S+\[(\S+)\] (\d+-[A-Za-z0-9@_-]+?-[A-Za-z0-9@_-]+) \d+ \d+ |</pcre2>
  <pcre2>^(\S+) (\d+-[A-Za-z0-9@_-]+?-[A-Za-z0-9@_-]+) \d+ \d+ </pcre2>
  <order>srcip, id</order>
</decoder>

<!-- Info section - SCAN -->
<decoder name="barracuda-svf1">
  <parent>barracuda-svf-email</parent>
  <pcre2 offset="after_regex">(SCAN) (\S+ \S+ \S+ \S+ \d+ \d+ .+ SUBJ:.+)$</pcre2>
  <order>action, extra_data</order>
</decoder>

<!-- Info section RECV -->
<decoder name="barracuda-svf1">
  <parent>barracuda-svf-email</parent>
  <pcre2 offset="after_regex">(RECV) (\S+ \S+ \d+ \d+ .+)$</pcre2>
  <order>action, extra_data</order>
</decoder>

<!-- Info section SEND -->
<decoder name="barracuda-svf1">
  <parent>barracuda-svf-email</parent>
  <pcre2 offset="after_regex">(SEND) (\S+ \d+ \S+ .+)$</pcre2>
  <order>action, extra_data</order>
</decoder>

<!-- Barracuda S&VF Administration-->

<decoder name="barracuda-svf-admin">
  <program_name_pcre2>^web</program_name_pcre2>
</decoder>

<decoder name="barracuda-svf-admin-change">
  <parent>barracuda-svf-admin</parent>
  <prematch_pcre2>^\[\S+\] global\[\] CHANGE</prematch_pcre2>
  <pcre2 offset="after_parent">^\[(\S+)\] global\[\] (CHANGE) (\S+ \(\S*)\)$</pcre2>
  <order>srcip,action,extra_data</order>
</decoder>

<decoder name="barracuda-svf-admin-auth">
  <parent>barracuda-svf-admin</parent>
  <prematch_pcre2>^\[\S+\] LOGIN|</prematch_pcre2>
  <prematch_pcre2>^\[\S+\] FAILED_LOGIN|</prematch_pcre2>
  <prematch_pcre2>^\[\S+\] LOGOUT</prematch_pcre2>
  <pcre2 offset="after_parent">^\[(\S+)\] (\S+) \((\S+)\)[()*+,.:;\<=>?\[\]!"'#%&$|{}-]*$</pcre2>
  <order>srcip,action,user</order>
</decoder>


<!-- 
  - Decoder for Sysmon Event ID 1: Process Created
  - Maintained by Josh Brower, Josh@DefensiveDepth.com 
  -
  -  OSSEC to Sysmon Fields Mapping:
  -  user = User
  -  status = Image
  -  url = Hash
  -  extra_data = ParentImage
  
  - Examples:
  - 2014 Dec 20 14:29:48 (HME-TEST-01) 10.0.15.14->WinEvtLog 2014 Dec 20 09:29:47 WinEvtLog: Microsoft-Windows-Sysmon/Operational: INFORMATION(1): Microsoft-Windows-Sysmon: SYSTEM: NT AUTHORITY: WIN-U93G48C7BOP: Process Create:  UtcTime: 12/20/2014 2:29 PM  ProcessGuid: {00000000-87DB-5495-0000-001045F25A00}  ProcessId: 3048  Image: C:\Windows\system32\svchost.exe  CommandLine: "C:\Windows\system32\NOTEPAD.EXE" C:\Users\Administrator\Desktop\ossec.log  User: WIN-U93G48C7BOP\Administrator  LogonGuid: {00000000-84B8-5494-0000-0020CB330200}  LogonId: 0x233CB  TerminalSessionId: 1  IntegrityLevel: High  HashType: SHA1  Hash: 9FEF303BEDF8430403915951564E0D9888F6F365  ParentProcessGuid: {00000000-84B9-5494-0000-0010BE4A0200}  ParentProcessId: 848  ParentImage: C:\Windows\Explorer.EXE  ParentCommandLine: C:\Windows\Explorer.EXE 
-->

<decoder name="Sysmon-EventID#1">
<type>windows</type>
<prematch_pcre2>INFORMATION\(1\)</prematch_pcre2>
<pcre2 offset="after_prematch">Image: (.*?) [ ]*?CommandLine: .*? [ ]*?User: (.*?) [ ]*?LogonGuid: \S*? [ ]*?LogonId: \S*? [ ]*?TerminalSessionId: \S*? [ ]*?IntegrityLevel: .*?HashType: \S*? [ ]*?Hash: (\S*?) [ ]*?ParentProcessGuid: \S*? [ ]*?ParentProcessID: \S*? [ ]*?ParentImage: (.*?) [ ]*?ParentCommandLine:</pcre2>
<order>status,user,url,data</order>
</decoder>

<!-- Squid access log decoder.
  - Will extract the srcip.
  - Author: Ahmet Ozturk
  - Examples:
  - 1140701044.525   1231 192.168.1.201 TCP_DENIED/400 1536
    GET ahmet - NONE/- text/html
  - 1140701230.827    781 192.168.1.210 TCP_DENIED/407 1785
    GET http://www.ossec.net oahmet NONE/- text/html
  -->
<decoder name="squid-accesslog">
  <type>squid</type>
  <prematch_pcre2>^\d+? \S+ </prematch_pcre2>
  <pcre2>^\d+? (\S+) ([A-Za-z0-9@_-]+?)/(\d+?) \d+? [A-Za-z0-9@_-]+? (\S+) </pcre2>
  <order>srcip,action,id,url</order>
</decoder>

<!-- unbound
  - 2014-05-20T09:01:07.283219-04:00 arrakis unbound: [9405:0] notice: sendto failed: Can't assign requested address
  - 2014-07-14T14:00:02.814490-04:00 arrakis unbound: [2541:0] info: 127.0.0.1 talkgadget.google.com. A IN
  - 2014-07-14T14:00:05.507848-04:00 arrakis unbound: [2541:0] info: server stats for thread 0: 3 queries, 2 answers from cache, 1 recursions, 0 prefetch
  - 2014-07-14T14:00:05.507955-04:00 arrakis unbound: [2541:0] info: server stats for thread 0: requestlist max 0 avg 0 exceeded 0 jostled 0
  - 2014-07-14T14:00:05.508075-04:00 arrakis unbound: [2541:0] info: average recursion processing time 0.038814 sec
  - 2014-07-14T14:00:05.508166-04:00 arrakis unbound: [2541:0] info: histogram of recursion processing times
  - 2014-07-14T14:00:05.508248-04:00 arrakis unbound: [2541:0] info: [25%]=0 median[50%]=0 [75%]=0
  - 2014-07-14T14:00:05.508333-04:00 arrakis unbound: [2541:0] info: lower(secs) upper(secs) recursions
  - 2014-07-14T14:00:05.508414-04:00 arrakis unbound: [2541:0] info:    0.032768    0.065536 1
  - 2014-07-14T15:05:07.520229-04:00 arrakis unbound: [2541:0] info: 127.0.0.1 github.com. AAAA IN
-->


<decoder name="unbound">
  <program_name_pcre2>^unbound</program_name_pcre2>
</decoder>

<decoder name="unbound-a">
  <parent>unbound</parent>
  <pcre2> info: (\S+) (\S+)\. A IN$| info: (\S+) (\S+) AAAA IN$</pcre2>
  <order>srcip,url</order>
</decoder>

<!-- OpenBSD doas -->
<decoder name="doas">
  <program_name_pcre2>^doas</program_name_pcre2>
</decoder>

<decoder name="doas-user">
  <parent>doas</parent>
  <pcre2>^(\S+) ran| for (\S+):</pcre2>
  <order>srcuser</order>
</decoder>

<decoder name="doas-user">
  <parent>doas</parent>
  <pcre2 offset="after_parent"> as (\S+): </pcre2>
  <order>dstuser</order>
</decoder>

<!-- Exim
  - Examples:
  - 2017-01-23 03:44:14 dovecot_login authenticator failed for (hydra) [10.101.1.18]:35686: 535 Incorrect authentication data (set_id=user)
  - 2017-01-24 05:22:29 dovecot_plain authenticator failed for (test) [::1]:39454: 535 Incorrect authentication data (set_id=test)
  - 2017-01-24 03:09:46 SMTP connection from [10.101.1.10]:55010 (TCP/IP connection count = 1)
  - 2017-01-24 02:53:13 SMTP connection from (hydra) [10.101.1.10]:53682 lost
  - 2017-01-24 05:36:23 SMTP call from (000000) [::1]:39480 dropped: too many syntax or protocol errors (last command was "123")
-->

<decoder name="exim-authfailed">
  <parent>windows-date-format</parent>
  <prematch_pcre2 offset="after_parent">authenticator failed</prematch_pcre2>
  <pcre2 offset="after_prematch">\[(\S+)\]:\d+: \d+ Incorrect authentication data \(set_id=([A-Za-z0-9@_-]+?)\)</pcre2>
  <order>srcip,user</order>
</decoder>

<decoder name="exim-connect">
  <parent>windows-date-format</parent>
  <prematch_pcre2 offset="after_parent">^SMTP connection from </prematch_pcre2>
  <pcre2 offset="after_prematch">\[(\S+)\]:\d+ \(TCP/IP connection count</pcre2>
  <order>srcip</order>
</decoder>

<decoder name="exim-disconnect">
  <parent>windows-date-format</parent>
  <prematch_pcre2 offset="after_parent">^SMTP connection from </prematch_pcre2>
  <pcre2 offset="after_prematch">\[(\S+)\]:\d+ lost</pcre2>
  <order>srcip</order>
</decoder>

<decoder name="exim-syntax-errors">
  <parent>windows-date-format</parent>
  <prematch_pcre2 offset="after_parent">^SMTP call from </prematch_pcre2>
  <pcre2 offset="after_prematch">\[(\S+)\]:\d+ dropped: too many syntax or protocol errors</pcre2>
  <order>srcip</order>
</decoder>

<!-- NSD
   - Aug 11 13:21:46 ix nsd[16565]: server initialization failed, nsd could not be started
   - Aug 11 13:22:14 ix nsd[13816]: blocked.hosts:2: syntax error
   - Aug 11 13:22:14 ix nsd[13816]: blocked.hosts:2: unrecognized RR type 'name:'
   - Aug 12 09:01:00 junction.example.com nsd[7405]: NSTATS 1439384460 1439314258 A=1 AAAA=1
   - Aug 12 09:01:00 junction.example.com nsd[7405]: XSTATS 1439384460 1439314258 RR=0 RNXD=0 RFwdR=0 RDupR=0 RFail=0 RFErr=0 RErr=0 RAXFR=0 RLame=0 ROpts=0 SSysQ=0 SAn
s=2 SFwdQ=0 SDupQ=0 SErr=0 RQ=2 RIQ=0 RFwdQ=0 RDupQ=0 RTCP=0 SFwdR=0 SFail=0 SFErr=0 SNaAns=0 SNXD=0 RUQ=0 RURQ=0 RUXFR=0 RUUpd=0
   - Dec 16 12:51:17 pine nsd[90235]: xfrd: zone example.com received error code NOT IMPL from 192.168.17.9@153
-->

<decoder name="nsd">
  <program_name_pcre2>^nsd</program_name_pcre2>
</decoder>

<decoder name="nsd-from">
  <parent>nsd</parent>
  <pcre2> from (\S+)@| from (\S+)</pcre2>
  <order>srcip</order>
</decoder>

<!-- ownCloud
   - Examples owncloud.log (Note that the syntax of failed login logs differs between oler and newer ownCloud versions):
   - {"reqId":"Jrd4fkwIcXhVjtP8qODR","level":2,"time":"2017-09-20T15:44:23+02:00","remoteAddr":"127.0.0.1","user":"--","app":"core","method":"POST","url":"\/login","message":"Login failed: 'admin' (Remote IP: '127.0.0.1')"}
   - {"reqId":"wlioIFa6pOvt6DIAoeHE","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1')","level":2,"time":"2016-04-12T22:28:20+02:00","method":"POST","url":"\/","user":"--"}
   - {"reqId":"prLlx9+QIfl1jHtz9C5o","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1')","level":2,"time":"2015-07-08T12:12:41+02:00"}
   - {"reqId":"wLP7a3MdzTo8wgCWret9","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1')","level":2,"time":"2015-07-15T09:40:35+02:00","method":"POST","url":"\/"}
   - {"reqId":"prLlx9+QIfl1jHtz9C5o","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1)","level":2,"time":"2015-07-08T12:12:41+02:00"}
   - {"reqId":"wLP7a3MdzTo8wgCWret9","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1)","level":2,"time":"2015-07-15T09:40:35+02:00","method":"POST","url":"\/"}
   - {"reqId":"f7906a8355f496e3a1947d7839c4a2c3","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1', X-Forwarded-For: '')","level":2,"time":"2015-06-09T08:17:43+00:00"}
   - {"reqId":"9f8edc5558b2b4f8628663d83a092a7f","remoteAddr":"127.0.0.1","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1', X-Forwarded-For: '')","level":2,"time":"2015-06-09T08:19:02   - +00:00","method":"POST","url":"\/cloud\/index.php"}
   - {"app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1', X-Forwarded-For: '')","level":2,"time":"2015-06-09T08:16:29+00:00"}
   - {"reqId":"5576a04643d8e","app":"core","message":"Login failed: 'admin' (Remote IP: '127.0.0.1', X-Forwarded-For: '')","level":2,"time":"2015-06-09T08:13:58+00:00","method":"POST","url":"\/owncloud\/index.php"}
   - {"app":"core","message":"Login failed: user 'admin' , wrong password, IP:127.0.0.1","level":2,"time":"2015-06-09T08:10:29+00:00"}
   - {"reqId":"55769fcacd1e0","app":"core","message":"Login failed: user 'admin' , wrong password, IP:127.0.0.1","level":2,"time":"2015-06-09T08:11:54+00:00","method":"POST","url":"\/owncloud\/index.php"}
   - {"reqId":"BaW6nfA5rHBoihjDtQVm","remoteAddr":"127.0.0.1","app":"core-preview","message":"Passed filename is not valid, might be malicious (file:\"test\";ip:\"127.0.0.1\")","level":2,"time":"2017-09-01T22:11:25+02:00","method":"POST","url":"\/login","user":"--"}
   - {"reqId":"4ETnKW0UyDBNmL4z\/umV","remoteAddr":"127.0.0.1","app":"PHP","message":"Redis::connect(): connect() failed: No such file or directory at \/var\/www\/owncloud\/lib\/private\/RedisFactory.php#60","level":3,"time":"2017-08-21T16:00:34+02:00","method":"PROPFIND","url":"\/remote.php\/dav\/addressbooks\/users\/admin\/example\/","user":"admin"}
   - {"reqId":"4j2DKpvOh0OezXVwfuLO","remoteAddr":"127.0.0.1","app":"PHP","message":"fopen(\/var\/www\/owncloud\/data\/user 1\/thumbnails\/1234\/32-32.png): failed to open stream: No such file or directory at \/var\/www\/owncloud\/lib\/private\/Files\/Storage\/Local.php#278","level":3,"time":"2017-07-15T23:59:20+02:00","method":"GET","url":"\/core\/preview.png?file=%2Fexample.txt&c=123&x=32&y=32&forceIcon=0","user":"user 1"}

   - Examples syslog:
   - Sep  1 20:16:09 foo ownCloud[15463]: {core} Login failed: 'test' (Remote IP: '127.0.0.1')
   - Sep  1 22:16:33 foo ownCloud[15467]: {core-preview} Passed filename is not valid, might be malicious (file:"test";ip:"127.0.0.1")
-->

<decoder name="owncloud">
  <prematch_pcre2>^\{"reqId":"\S+","message":".+","level":\d,"time":".+"\}$|^\{"app":"\S+","message":".+","level":\d,"time":".+"\}$|^\{"reqId":"\S+","level":\d,"time":"\S+","message":".+"\}$</prematch_pcre2>
</decoder>

<!-- Note: This defaults to "ownCloud" but users can change the syslog tag: https://github.com/owncloud/core/blob/v10.0.2/config/config.sample.php#L608-L614 -->
<decoder name="owncloud">
  <program_name_pcre2>^ownCloud</program_name_pcre2>
</decoder>

<decoder name="owncloud-failed1">
  <parent>owncloud</parent>
  <prematch_pcre2>Login failed: user </prematch_pcre2>
  <pcre2 offset="after_prematch">^'([A-Za-z0-9@_-]+)' , wrong password, IP:(\S+)</pcre2>

  <order>user, srcip</order>
</decoder>

<decoder name="owncloud-failed2">
  <parent>owncloud</parent>

  <prematch_pcre2>Login failed: </prematch_pcre2>
  <pcre2 offset="after_prematch">^'([A-Za-z0-9@_-]+)' \(Remote IP: '(\S+)'|^'([A-Za-z0-9@_-]+)' \(Remote IP: '(\S+)\)</pcre2>
  <order>user, srcip</order>
</decoder>

<decoder name="owncloud-malicious">
  <parent>owncloud</parent>

  <prematch_pcre2>Passed filename is not valid, might be malicious </prematch_pcre2>
  <pcre2 offset="after_prematch">;ip:"(\S+)"|;ip:\\"(\S+)\\"</pcre2>

  <order>srcip</order>
</decoder>

<decoder name="owncloud-loglevel">
  <parent>owncloud</parent>
  <prematch_pcre2>","level":</prematch_pcre2>
  <pcre2 offset="after_prematch">^(\d),"</pcre2>
  <order>status</order>
</decoder>

<!-- psad
  - Examples: (Note: IPv6 untested)
  - Sep  8 22:52:30 sni psad: scan detected (Nmap -sT or -sS scan): 212.83.152.232 -> 1.2.3.4 tcp: [21943] flags: SYN tcp pkts: 3 DL: 3
  - Sep  9 08:36:30 sni psad: src: 62.210.167.199 signature match: "BACKDOOR DoomJuice file upload attempt" (sid: 2375) tcp port: 3180
  - Sep  9 08:36:30 sni psad: scan detected (Masscan SYN scan): 62.210.167.199 -> 1.2.3.4 tcp: [3320-62210] flags: SYN tcp pkts: 10 DL: 3
  - Sep  3 14:18:52 sni psad: scan detected ( -sU scan): 192.168.1.42 -> 239.255.255.250 udp: [1900] udp pkts: 16 DL: 3
  - Sep  4 11:33:23 sni psad: src: 46.17.46.8 signature match: "MISC Microsoft PPTP communication attempt" (sid: 100082) tcp port: 1723
  - Sep  4 11:33:23 sni psad: src: 46.17.46.8 signature match: "DOS iParty DOS attempt" (sid: 1605) tcp port: 6004
  - Sep  4 11:33:23 sni psad: src: 46.17.46.8 signature match: "DOS Real Audio Server communication attempt" (sid: 100112) tcp port: 7070
  - Sep  4 11:33:23 sni psad: src: 46.17.46.8 signature match: "BACKDOOR DoomJuice file upload attempt" (sid: 2375) tcp port: 3129
  - Aug  9 16:46:32 dsc psad: message repeated 2 times: [ scan detected (Nmap -sT or -sS scan): 10.1.0.15 -> 192.168.1.18 tcp: [80] flags: SYN tcp pkts: 3 DL: 3]example logs: 
-->

<decoder name="psad">
  <program_name_pcre2>psad</program_name_pcre2>
</decoder>

<decoder name="psad-scan">
  <parent>psad</parent>
  <prematch_pcre2>^scan detected </prematch_pcre2>
  <pcre2 offset="after_prematch"> (\S+) -> (\S+) .+ DL: (\d)</pcre2>
  <order>srcip,dstip,status</order>
</decoder>

<decoder name="psad-repeated">
  <parent>psad</parent>
  <prematch_pcre2>^message repeated</prematch_pcre2>
  <pcre2 offset="after_prematch"> (\S+) -> (\S+) .+ DL: (\d)</pcre2>
  <order>srcip,dstip,status</order>
</decoder>

<decoder name="psad-signature">
  <parent>psad</parent>
  <prematch_pcre2>signature match: </prematch_pcre2>
  <pcre2 offset="after_parent">src: (\S+) signature match: .+ port: (\d+)</pcre2>
  <order>srcip,dstport</order>
</decoder>

<!-- Proxmox Virtual Environment (Proxmox VE)
   - Examples syslog:
   - Sep 10 22:12:41 example pvedaemon[6427]: authentication failure; rhost=192.168.0.1 user=root@pam msg=Authentication failure
   - Sep 10 22:12:49 example pvedaemon[6428]: authentication failure; rhost=192.168.0.1 user=root@pve msg=no such user ('root@pve')
   - Sep 10 22:12:54 example pvedaemon[6428]: <root@pam> successful auth for user 'root@pam'
   - Sep 10 22:13:44 example pvedaemon[6427]: <root@pam> starting task UPID:example:00000000:11111111:22222222:vzstart:100:root@pam:
   - Sep 10 22:13:44 example pvedaemon[13735]: starting CT 100: UPID:example:00000000:11111111:22222222:vzstart:100:root@pam:
   - Sep 10 22:13:46 example pvedaemon[6427]: <root@pam> end task UPID:example:00000000:11111111:22222222:vzstart:100:root@pam: OK
   - Sep 10 22:13:47 example pvestatd[1892]: modified cpu set for lxc/100: 4
   - Sep 10 06:25:44 example pveproxy[15342]: received signal TERM
   - Sep 10 06:25:44 example pveproxy[15342]: server closing
   - Sep 10 06:25:44 example pveproxy[15345]: worker exit
   - Sep 10 06:25:44 example pveproxy[15344]: worker exit
   - Sep 10 06:25:44 example pveproxy[15343]: worker exit
   - Sep 10 06:25:44 example pveproxy[15342]: worker 15343 finished
   - Sep 10 06:25:44 example pveproxy[15342]: worker 15344 finished
   - Sep 10 06:25:44 example pveproxy[15342]: worker 15345 finished
   - Sep 10 06:25:44 example pveproxy[15342]: server stopped
   - Sep 10 06:25:45 example pveproxy[22375]: Using '/etc/pve/local/pveproxy-ssl.pem' as certificate for the web interface.
   - Sep 10 06:25:45 example pveproxy[22413]: starting server
   - Sep 10 06:25:45 example pveproxy[22413]: starting 3 worker(s)
   - Sep 10 06:25:45 example pveproxy[22413]: worker 22414 started
   - Sep 10 06:25:45 example pveproxy[22413]: worker 22415 started
   - Sep 10 06:25:45 example pveproxy[22413]: worker 22416 started
   - Sep 10 06:25:47 example pvepw-logger[15428]: received terminate request (signal)
   - Sep 10 06:25:47 example pvepw-logger[15428]: stopping pvefw logger
   - Sep 10 06:25:48 example pvepw-logger[22551]: starting pvefw logger
-->

<decoder name="pvedaemon">
  <program_name_pcre2>^pvedaemon</program_name_pcre2>
</decoder>

<decoder name="pvestatd">
  <program_name_pcre2>^pvestatd</program_name_pcre2>
</decoder>

<decoder name="pveproxy">
  <program_name_pcre2>^pveproxy</program_name_pcre2>
</decoder>

<decoder name="pvepw-logger">
  <program_name_pcre2>^pvepw-logger</program_name_pcre2>
</decoder>

<decoder name="pvedaemon-auth-failed">
  <parent>pvedaemon</parent>
  <prematch_pcre2>authentication failure; </prematch_pcre2>
  <pcre2 offset="after_prematch">^rhost=(\S+) user=(\S+)@pam msg=|^rhost=(\S+) user=(\S+)@pve msg=</pcre2>
  <order>srcip, user</order>
</decoder>

<decoder name="pvedaemon-auth-success">
  <parent>pvedaemon</parent>
  <prematch_pcre2>successful auth for user '</prematch_pcre2>
  <pcre2 offset="after_prematch">^(\S+)@pam'$|^(\S+)@pve'$</pcre2>
  <order>user</order>
</decoder>

<decoder name="dhcpd">
  <program_name_pcre2>^dhcpd$</program_name_pcre2>
</decoder>

<decoder name="dhcpd-data">
  <parent>dhcpd</parent>
  <pcre2 offset="after_parent">^(\S+) \S+ (\S+) \S+ (\S+) via (\S+)$</pcre2>
  <order>action, srcip, extra_data, extra_data</order>
</decoder>

<decoder name="dhcpd-ack">
  <parent>dhcpd</parent>
  <prematch_pcre2> acking </prematch_pcre2>
  <pcre2 offset="after_parent">already acking lease (\S+)</pcre2>
  <order>srcip</order>
</decoder>

<decoder name="dhcpd-release">
  <parent>dhcpd</parent>
  <prematch_pcre2>^IP address</prematch_pcre2>
  <pcre2 offset="after_parent">^IP address (\S+) </pcre2>
  <order>srcip</order>
</decoder>

<!-- OpenBSD httpd -->
<decoder name="openbsd-httpd">
  <prematch_pcre2> \[\d+/[A-Za-z0-9@_-]+/\d+:\d+:\d+:\d+ -\d+\] "</prematch_pcre2>
  <pcre2>^(\S+) (\S+) \S+ \S+ \[\d+/[A-Za-z0-9@_-]+/\d+:\d+:\d+:\d+ -\d+\] "(\S+) (\S+) HTTP/\d\.\d" (\d+?) \d$</pcre2>
  <order>url, srcip, protocol, url, status</order>
  <type>web-log</type>
</decoder>

<!-- dnsmasq -->
<decoder name="dnsmasq">
  <!--<program_name>^dnsmasq</program_name>-->
  <prematch_pcre2>^dnsmasq</prematch_pcre2>
</decoder>

<decoder name="dnsmasq2">
  <parent>dnsmasq</parent>
  <pcre2 offset="after_parent">^\[\d+\]: \d+ (\S+)/\d+ (\S+) (\S+) to (\S+)|</pcre2>
  <pcre2>^\[\d+\]: \d+ (\S+)/\d+ (\S+) (\S+) from (\S+)|</pcre2>
  <pcre2>^\[\d+\]: \d+ (\S+)/\d+ (\S+) (\S+) is (\S+)</pcre2>
  <order>srcip, action, url, extra_data</order>
</decoder>

<!-- Kaspersky Endpoint Security 10 for Linux -->
<!-- Kesl example Logs -->
<!-- Nov  5 00:11:21 hostname kesl: {"EventType": "AVBasesAreTotallyOutOfDate","EventId": "27336","TaskName": "Update","TaskId": "6","AVBasesDate": "2018-10-17 09:49:00"} -->
<!-- Oct 25 13:11:21 hostname kesl: {"EventType": "AVBasesAreOutOfDate","EventId": "27311","TaskName": "Update","TaskId": "6","AVBasesDate": "2018-10-17 09:49:00"} -->
<!-- Nov 10 13:19:27 hostname kesl: {"EventType": "UpdateError","EventId": "27381","TaskType": "Update","TaskName": "Update","TaskId": "6","RuntimeTaskId": "120"} -->
<!-- Nov 10 13:22:09 hostname kesl: {"EventType": "ThreatDetected","EventId": "27384","DetectName": "EICAR-Test-File","DetectType": "Virware","DetectCertainty": "Sure","DetectSource": "Local","FileName": "/home/userlogin/eicar.com","ObjectName": "File","TaskId": "1","RuntimeTaskId": "20","TaskName": "File_Monitoring","TaskType": "OAS","AccessUser": "root","AccessUserId": "0","FileOwner": "root","FileOwnerId": "0"} -->
<!-- Nov 14 13:50:01 hostname kesl: {"EventType": "ObjectSavedToBackup","EventId": "27448","FileName": "/home/userlogin/eicar.com","ObjectName": "File","TaskId": "1","RuntimeTaskId": "126","TaskName": "File_Monitoring","TaskType": "OAS","AccessUser": "userlogin","AccessUserId": "1000","FileOwner": "root","FileOwnerId": "0"} -->
<!-- Nov 14 13:50:01 hostname kesl: {"EventType": "ObjectNotDisinfected","EventId": "27449","ObjectNotDisinfectedReason": "NonCurable","FileName": "/home/userlogin/eicar.com","ObjectName": "File","TaskId": "1","RuntimeTaskId": "126","TaskName": "File_Monitoring","TaskType": "OAS","AccessUser": "userlogin","AccessUserId": "1000","FileOwner": "root","FileOwnerId": "0"} -->
<!-- Nov 14 13:50:01 hostname kesl: {"EventType": "ObjectDeleted","EventId": "27450","FileName": "/home/userlogin/eicar.com","ObjectName": "File","TaskId": "1","RuntimeTaskId": "126","TaskName": "File_Monitoring","TaskType": "OAS","AccessUser": "userlogin","AccessUserId": "1000","FileOwner": "root","FileOwnerId": "0"} -->
<!-- Nov 14 12:44:04 hostname kesl: {"EventType": "TaskStateChanged","EventId": "27438","TaskName": "Update","TaskType": "Update","TaskId": "6","TaskState": "Starting","PrevTaskState": "Stopped","TaskRequestInitiator": "User","RuntimeTaskId": "127"} -->
<!-- Nov 14 12:44:04 hostname kesl: {"EventType": "TaskStateChanged","EventId": "27439","TaskName": "Update","TaskType": "Update","TaskId": "6","TaskState": "Started","PrevTaskState": "Starting","TaskRequestInitiator": "User","RuntimeTaskId": "127"} -->

<decoder name="kesl">
  <program_name_pcre2>^kesl</program_name_pcre2>
</decoder>

<decoder name="kesl-avbases-old">
  <parent>kesl</parent>
  <prematch_pcre2>^""EventType": "\S+","EventId": "\d+?","TaskName": "\S+","TaskId": "\d+?","AVBasesDate": "\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}""</prematch_pcre2>
  <pcre2 offset="after_parent">^""EventType": "(\S+)","EventId": "(\d+?)","TaskName": "(\S+)","TaskId": "\d+?","AVBasesDate": "(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})""</pcre2>
  <order>status, id, action, extra_data</order> 
</decoder>

<decoder name="kesl-threat-detected">
  <parent>kesl</parent>
  <prematch_pcre2>^""EventType": "\S+","EventID": "\d+","DetectName": "\S+","DetectType": "\S+","DetectCertainty": "\S+","DetectSource": "\S+","FileName": "\S+,"ObjectName": "\S+","TaskId": "\d+?","RuntimeTaskId": "\d+","TaskName": "\S+","TaskType": "\S+","AccessUser": "\S+","AccessUserId": "\d+","FileOwner": "\S+","FileOwnerId": "\d+""</prematch_pcre2>
  <pcre2 offset="after_parent">^""EventType": "(\S+)","EventID": "(\d+)","DetectName": "\S+","DetectType": "\S+","DetectCertainty": "(\S+)","DetectSource": "\S+","FileName": \S+,"ObjectName": "\S+","TaskId": "\d+","RuntimeTaskId": "\d+?","TaskName": "\S+","TaskType": "(\S+)","AccessUser": "\S+","AccessUserId": "\d+?","FileOwner": "\S+","FileOwnerId": "\d+""</pcre2>
  <order>status, id, extra_data, action</order>
</decoder>

<decoder name="kesl-taskstatechange">
  <parent>kesl</parent>
  <prematch_pcre2>^""EventType": "\S+","EventId": "\d+","TaskName": "\S+","TaskType": "\S+","TaskId": "\d+","TaskState": "\S+","PrevTaskState": "\S+","TaskRequestInitiator": "\S+","RuntimeTaskId": "\d+""</prematch_pcre2>
  <pcre2 offset="after_parent">^""EventType": "(\S+)","EventId": "(\d+)","TaskName": "\S+","TaskType": "(\S+)","TaskId": "\d+","TaskState": "(\S+)","PrevTaskState": "\S+","TaskRequestInitiator": "(\S+)","RuntimeTaskId": "\d+""</pcre2>
  <order>action, id, extra_data, status, srcuser</order>
</decoder>

<!-- MHN - Json log decoder - Dionaea -->
<!-- include /var/log/mhn/mhn-json.log to ossec.conf -->
<!-- {"direction": "inbound", "protocol": "ip", "ids_type": "network", "timestamp": "2018-09-14T11:02:54.215411", "dionaea_action": "reject", "type": "dionaea.connections", "app": "dionaea", "src_ip": "16.10.10.10", "vendor_product": "Dionaea", "dest_port": 365, "signature": "Connection to Honeypot", "src_port": 45302, "dest_ip": "16.10.10.11", "sensor": "5e7031cf-b74d-22f9-57e0-254166752457", "transport": "tcp", "severity": "high"} -->
<decoder name="dionaea">
  <prematch_pcre2>dionaea\.connections</prematch_pcre2>
  <pcre2>^\{"direction": "(\S+)", "protocol": "(\S+)", "ids_type": "\S+", "timestamp": "\d{4}-\d{2}-\d{2}\w\d{2}:\d{2}:\d{2}.\d+", "dionaea_action": "(\S+)", "type": "dionaea\.connections", "app": "dionaea", "src_ip": "(\S+)", "vendor_product": "Dionaea", "dest_port": (\d+), "signature": ".+", "src_port": (\d+?), "dest_ip": "(\S+)", "sensor": \S+, "transport": "\S+", "severity": "\S+"\}</pcre2>
  <order>extra_data, protocol, action, srcip, dstport, srcport, dstip</order>
</decoder>

<!-- MHN - Json log decoder - Cowrie -->
<!-- include /var/log/mhn/mhn-json.log to ossec.conf -->
<!-- {"direction": "inbound", "protocol": "ip", "ids_type": "network", "ssh_username": "admin", "app": "cowrie", "transport": "tcp", "dest_port": 22, "src_port": 45302, "severity": "high", "timestamp": "2018-10-23T11:22:36.597864", "vendor_product": "Cowrie", "sensor": "5e7031cf-b74d-22f9-57e0-254166752457", "src_ip": "16.10.10.10", "ssh_password": "password", "signature": "SSH login attempted on cowrie honeypot", "ssh_version": "'SSH-2.0-Sun_SSH_1.1.4'", "type": "cowrie.sessions", "dest_ip": "16.10.10.11"} -->
<!-- {"direction": "inbound", "protocol": "ip", "ids_type": "network", "timestamp": "2018-10-23T07:45:56.937787", "vendor_product": "Cowrie", "type": "cowrie.sessions", "app": "cowrie", "src_ip": "16.10.10.10", "dest_port": 22, "signature": "SSH session on cowrie honeypot", "ssh_version": "'SSH-2.0-Sun_SSH_1.1.4'", "src_port": 45302, "dest_ip": "16.10.10.11", "sensor": "5e7031cf-b74d-22f9-57e0-254166752457", "transport": "tcp", "severity": "high"} -->
<!-- {"direction": "inbound", "protocol": "ip", "ids_type": "network", "timestamp": "2018-11-14T10:32:38.686578", "app": "cowrie", "transport": "tcp", "dest_port": 22, "src_port": 45302, "severity": "high", "vendor_product": "Cowrie", "sensor": "5e7031cf-b74d-22f9-57e0-254166752457", "src_ip": "16.10.10.10", "command": "whoami", "signature": "command attempted on cowrie honeypot", "ssh_version": "'SSH-2.0-OpenSSH_7.4p1 Debian-10+deb9u4'", "type": "cowrie.sessions", "dest_ip": "16.10.10.11"} -->

<decoder name="cowrie">
  <prematch_pcre2>cowrie\.sessions</prematch_pcre2>
</decoder>

<decoder name="cowrie-attempt">
  <parent>cowrie</parent>
  <prematch_pcre2>"SSH login attempted</prematch_pcre2>
  <pcre2>^\{"direction": "\S+", "protocol": "(\S+)", "ids_type": "(\S+)", "ssh_username": "(\S+)", "app": "cowrie", "transport": "\S+", "dest_port": (\d+), "src_port": (\d+), "severity": "\S+", "timestamp": "\d{4}-\d{2}-\d{2}", "vendor_product": "Cowrie", "sensor": \S+, "src_ip": "(\S+)", "ssh_password": "\S+", "signature": "(.+)", "ssh_version": .+, "type": "cowrie\.sessions", "dest_ip": "(\S+)"\}</pcre2>
  <order>protocol, extra_data, user, dstport, srcport, srcip, action, dstip</order>
</decoder>

<decoder name="cowrie-session">
  <parent>cowrie</parent>
  <prematch_pcre2>"SSH session on cowrie honeypot</prematch_pcre2>
  <pcre2>^\{"direction": "\S+", "protocol": "(\S+)", "ids_type": "(\S+)", "timestamp": "\d{4}-\d{2}-\d{2}\w\d{2}:\d{2}:\d{2}.\d+", "vendor_product": "Cowrie", "type": "cowrie\.sessions", "app": "cowrie", "src_ip": "(\S+)", "dest_port": (\d+?), "signature": "(.+)", "ssh_version": .+, "src_port": (\d+?), "dest_ip": "(\S+)", "sensor": \S+, "transport": "\S+", "severity": "\S+"\}</pcre2>
  <order>protocol, extra_data, srcip, dstport, action, srcport, dstip</order>
</decoder>

<decoder name="cowrie-command">
  <parent>cowrie</parent>
  <prematch_pcre2>"command attempted on cowrie honeypot</prematch_pcre2>
  <pcre2>^\{"direction": "\S+", "protocol": "(\S+)", "ids_type": "(\S+)", "timestamp": "\d{4}-\d{2}-\d{2}\w\d{2}:\d{2}:\d{2}.\d+", "app": "cowrie", "transport": "\S+", "dest_port": (\d+?), "src_port": (\d+?), "severity": "\S+", "vendor_product": "Cowrie", "sensor": \S+, "src_ip": "(\S+)", "command": "\S+", "signature": "(.+)", "ssh_version": .+, "type": "cowrie\.sessions", "dest_ip": "(\S+)"\}</pcre2>
  <order>protocol, extra_data, dstport, srcport, srcip, action, dstip</order>
</decoder>

<!-- EOF -->
